[{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"The MIT License","title":"The MIT License","text":"Copyright 2024 Statistisk sentralbyrå - Statistics Norway Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/SECURITY.html","id":null,"dir":"","previous_headings":"","what":"Security Policy","title":"Security Policy","text":"SSB takes security software products services seriously, includes source code repositories managed GitHub organization. believe responsible disclosure security vulnerabilities helps us ensure security privacy users.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/SECURITY.html","id":"reporting-a-vulnerability","dir":"","previous_headings":"","what":"Reporting a Vulnerability","title":"Security Policy","text":"believe found security vulnerability SSB’s GitHub repositories, please report us using Github Private vulnerability reporting tool.","code":""},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"example-without-code","dir":"Articles","previous_headings":"Introductory example","what":"Example without code","title":"Introduction to 'SmallCountRounding'","text":"First data rounded. Table 1: Original data tabular form row column totals inner cells rounded. Thereafter new totals computed. underlying algorithm tries keep values totals close original ones. Table 2: small inner cell values (1-4) rounded using 5 rounding base. inner cells going published, number cells rounded can limited. Table 3: Assuming row column totals published, necessary small inner cell values (1-4) rounded using 5 rounding base.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"the-example-dataset-in-table-1","dir":"Articles","previous_headings":"Introductory example","what":"The example dataset in Table 1","title":"Introduction to 'SmallCountRounding'","text":"","code":"library(SmallCountRounding) z <- SmallCountData(\"exPSD\") z rows cols freq 1  row1 col1    6 2  row2 col1    1 3  row3 col1    0 4  row1 col2    0 5  row2 col2    2 6  row3 col2    1 7  row1 col3    1 8  row2 col3    3 9  row3 col3    1 10 row1 col4    3 11 row2 col4    1 12 row3 col4    0 13 row1 col5    4 14 row2 col5    2 15 row3 col5    2"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"rounding-all-small-cells-table-2","dir":"Articles","previous_headings":"Introductory example","what":"Rounding all small cells (Table 2)","title":"Introduction to 'SmallCountRounding'","text":"avoid small values range 1-4 can use 5 rounding base. result given Table 2 can bee seen output elements . output element publish contains original rounded versions 24 values Table 2. corresponding element inner contains 15 inner cells similar input data. values publish additive. , marginal cells (Totals) can computed straightforwardly inner original rounded counts.","code":"a <- PLSrounding(z, freqVar = \"freq\", roundBase = 5, dimVar = c(\"rows\", \"cols\")) a$inner rows cols original rounded difference 1  row1 col1        6       6          0 2  row2 col1        1       0         -1 3  row3 col1        0       0          0 4  row1 col2        0       0          0 5  row2 col2        2       0         -2 6  row3 col2        1       0         -1 7  row1 col3        1       0         -1 8  row2 col3        3       5          2 9  row3 col3        1       0         -1 10 row1 col4        3       5          2 11 row2 col4        1       0         -1 12 row3 col4        0       0          0 13 row1 col5        4       5          1 14 row2 col5        2       0         -2 15 row3 col5        2       5          3 a$publish rows  cols original rounded difference 1  Total Total       27      26         -1 2  Total  col1        7       6         -1 3  Total  col2        3       0         -3 4  Total  col3        5       5          0 5  Total  col4        4       5          1 6  Total  col5        8      10          2 7   row1 Total       14      16          2 8   row1  col1        6       6          0 9   row1  col2        0       0          0 10  row1  col3        1       0         -1 11  row1  col4        3       5          2 12  row1  col5        4       5          1 13  row2 Total        9       5         -4 14  row2  col1        1       0         -1 15  row2  col2        2       0         -2 16  row2  col3        3       5          2 17  row2  col4        1       0         -1 18  row2  col5        2       0         -2 19  row3 Total        4       5          1 20  row3  col1        0       0          0 21  row3  col2        1       0         -1 22  row3  col3        1       0         -1 23  row3  col4        0       0          0 24  row3  col5        2       5          3"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"rounding-necessary-small-inner-cell-table-3","dir":"Articles","previous_headings":"Introductory example","what":"Rounding necessary small inner cell (Table 3)","title":"Introduction to 'SmallCountRounding'","text":"Assuming row column totals published, publishable cells can defined formula ~rows+cols. Rounding can now performed : result given Table 3 can bee seen output elements .","code":"b <- PLSrounding(z, \"freq\", 5, formula = ~rows + cols) b$inner rows cols original rounded difference 1  row1 col1        6       6          0 2  row2 col1        1       1          0 3  row3 col1        0       0          0 4  row1 col2        0       0          0 5  row2 col2        2       0         -2 6  row3 col2        1       5          4 7  row1 col3        1       0         -1 8  row2 col3        3       5          2 9  row3 col3        1       0         -1 10 row1 col4        3       5          2 11 row2 col4        1       0         -1 12 row3 col4        0       0          0 13 row1 col5        4       4          0 14 row2 col5        2       2          0 15 row3 col5        2       0         -2 b$publish rows  cols original rounded difference 1 Total Total       27      28          1 2  row1 Total       14      15          1 3  row2 Total        9       8         -1 4  row3 Total        4       5          1 5 Total  col1        7       7          0 6 Total  col2        3       5          2 7 Total  col3        5       5          0 8 Total  col4        4       5          1 9 Total  col5        8       6         -2"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"unique-output-obtained-by-local-random-generator-seed","dir":"Articles","previous_headings":"Introductory example","what":"Unique output obtained by local random generator seed","title":"Introduction to 'SmallCountRounding'","text":"underlying algorithm sequential. Within loop, next cell given rounding base value selected according criterion. Random draw used draw criterion. ensure unique output, fixed random generator seed used locally within function without affecting random value stream R. See documentation rndSeed, parameter RoundViaDummy.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"the-output-object","dir":"Articles","previous_headings":"Introductory example","what":"The output object","title":"Introduction to 'SmallCountRounding'","text":"result printing output PLSrounding (b ): First utility measures printet. example maxdiff maximum difference original rounded cells within publish. Thereafter table frequencies cell frequencies absolute differences printed. Summary inner publish shown left right parts table, respectively. example, row rounded column inn.6+ number rounded inner cell frequencies greater equal 6. last row (absDiff) based differences without signs. possible compute manually printed utility measures : measures also found output element metrics together measures based inner. See ?HDutility information utility measure based Hellinger distance. Apart printing, output usual list summary works usual. output element freqTable table seen output object printed (frequencies cell frequencies absolute differences).","code":"a PLSrounding summary:           maxdiff      HDutility    meanAbsDiff rootMeanSquare               4          0.744         1.3333         1.6833   Frequencies of cell frequencies and absolute differences:             inn.0 inn.1-4 inn.5 inn.6+ inn.all pub.0 pub.1-4 pub.5 pub.6+ pub.all original     3      11     .      1      15     3      14     1      6      24 rounded     10       .     4      1      15    11       .     8      5      24 absDiff      4      11     .      .      15     5      19     .      .      24 b PLSrounding summary:           maxdiff      HDutility    meanAbsDiff rootMeanSquare               2          0.941              1         1.2019   Frequencies of cell frequencies and absolute differences:             inn.0 inn.1-4 inn.5 inn.6+ inn.all pub.0 pub.1-4 pub.5 pub.6+ pub.all original     3      11     .      1      15     .       3     1      5       9 rounded      8       3     3      1      15     .       .     4      5       9 absDiff      7       8     .      .      15     2       7     .      .       9 f <- b$publish$original g <- b$publish$rounded print(c(   maxdiff        =  max(abs(g - f)),    HDutility      =  HDutility(f, g),    meanAbsDiff    =  mean(abs(g - f)),    rootMeanSquare =  sqrt(mean((g - f)^2)) )) maxdiff      HDutility    meanAbsDiff rootMeanSquare        2.000000       0.940951       1.000000       1.201850 summary(b) Length Class      Mode    inner      5     data.frame list    publish    5     data.frame list    metrics    9     -none-     numeric freqTable 30     -none-     numeric"},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"example-without-code-1","dir":"Articles","previous_headings":"Hierarchical data","what":"Example without code","title":"Introduction to 'SmallCountRounding'","text":"small data set used input. Table 4: Input data  variables geo eu hierarchical related. data set can processed several ways. cases, entire table input cases eu column can omitted. , hierarchical information sent input another way. One possibility table , hierarchy coded r package sdcTable. Table 5: Hierarchy, geo  Another possibility TauArgus coding. general coding also possible. See ?AutoHierarchies information. output case possible combinations (including inner cells) published. Also example use 5 rounding base. can seen , output can generated several ways. inner cells colored according rounding. Table 6: Ouput data (publish)","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"data-table-4-and-hierarchies-table-5","dir":"Articles","previous_headings":"Hierarchical data","what":"Data (Table 4) and hierarchies (Table 5)","title":"Introduction to 'SmallCountRounding'","text":"seen , hierarchy specified variables. eDimList$geo given Table 5 eDimList$year plain hierarchy total code.","code":"e6  <-  SmallCountData(\"e6\")             # As Table 4  eDimList <- SmallCountData(\"eDimList\") eDimList $geo   levels    codes 1      @    Total 2     @@       EU 3    @@@ Portugal 4    @@@    Spain 5     @@    nonEU 6    @@@  Iceland  $year   levels codes 1      @ Total 2     @@  2018 3     @@  2019"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"four-ways-to-produce-table-6","dir":"Articles","previous_headings":"Hierarchical data","what":"Four ways to produce Table 6","title":"Introduction to 'SmallCountRounding'","text":"four lines produce results element publish Table 6. Ordering rows can different. b) d), function uses hierarchies calculations. b) hierarchies found automatically input data. ), dimVar assumed variables except freq. c) cross-classifications found formula. addition, hierarchical relations input data analysed geo eu combined output column. e), cross hierarchies defined formula.","code":"#  PLSrounding(e6, \"freq\", 5) # This is no longer possible. See ver. 1.1.0 news # a) PLSrounding(e6, \"freq\", 5, dimVar = c(\"geo\", \"eu\", \"year\"))                     # b)  PLSrounding(e6, \"freq\", 5, formula = ~eu * year + geo * year)                   # c) PLSrounding(e6[, -2], \"freq\", 5, hierarchies = eDimList)                        # d) PLSrounding(e6[, -2], \"freq\", 5, hierarchies = eDimList, formula = ~geo * year) # e)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/articles/Introduction_to_SmallCountRounding.html","id":"remarks-and-other-parameters","dir":"Articles","previous_headings":"Hierarchical data","what":"Remarks and other parameters","title":"Introduction to 'SmallCountRounding'","text":"difference occur combinations contained input data. c) limit output combinations available input. cases zeroes added. extra zeroes can avoided using removeEmpty=TRUE. Note also parameter inputInOutput can used specify whether include codes input. example incomplete input data using parameters. case single inner cell needed rounded (Iceland, 2019). original small value (Portugal, 2018) retained.","code":"out <- PLSrounding(e6[-1, ], \"freq\", 5, removeEmpty = TRUE, inputInOutput = c(FALSE,TRUE),                    dimVar = c(\"geo\", \"eu\", \"year\")) out PLSrounding summary:           maxdiff      HDutility    meanAbsDiff rootMeanSquare               1         0.8925            0.5         0.7071   Frequencies of cell frequencies and absolute differences:             inn.0 inn.1-4 inn.5 inn.6+ inn.all pub.0 pub.1-4 pub.5 pub.6+ pub.all original     .       2     1      2       5     .       2     .      6       8 rounded      1       1     1      2       5     2       .     .      6       8 absDiff      4       1     .      .       5     4       4     .      .       8 out$inner geo year original rounded difference 2 Portugal 2018        3       3          0 3    Spain 2018        7       7          0 4  Iceland 2019        1       0         -1 5 Portugal 2019        5       5          0 6    Spain 2019        6       6          0 out$publish geo  year original rounded difference 1 Total Total       22      21         -1 2 Total  2018       10      10          0 3 Total  2019       12      11         -1 4    EU Total       21      21          0 5    EU  2018       10      10          0 6    EU  2019       11      11          0 7 nonEU Total        1       0         -1 8 nonEU  2019        1       0         -1"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Øyvind Langsrud. Author, maintainer. Johan Heldal. Author.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Langsrud Ø, Heldal J (2025). SmallCountRounding: Small Count Rounding Tabular Data. R package version 1.1.1, https://statisticsnorway.github.io/ssb-smallcountrounding/, https://github.com/statisticsnorway/ssb-smallcountrounding.","code":"@Manual{,   title = {SmallCountRounding: Small Count Rounding of Tabular Data},   author = {Øyvind Langsrud and Johan Heldal},   year = {2025},   note = {R package version 1.1.1, https://statisticsnorway.github.io/ssb-smallcountrounding/},   url = {https://github.com/statisticsnorway/ssb-smallcountrounding}, }"},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/index.html","id":"small-count-rounding-of-tabular-data","dir":"","previous_headings":"","what":"Small Count Rounding of Tabular Data","title":"Small Count Rounding of Tabular Data","text":"See package vignette: Introduction ‘SmallCountRounding’","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/index.html","id":"installation","dir":"","previous_headings":"Small Count Rounding of Tabular Data","what":"Installation","title":"Small Count Rounding of Tabular Data","text":"can install SmallCountRounding CRAN Alternatively install GitHub bydevtools::install_github(\"statisticsnorway/SmallCountRounding\") want test newest changes.","code":"install.packages(\"SmallCountRounding\")"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/index.html","id":"a-statistical-disclosure-control-tool-to-protect-frequency-tables-in-cases-where-small-values-are-sensitive","dir":"","previous_headings":"Small Count Rounding of Tabular Data","what":"A statistical disclosure control tool to protect frequency tables in cases where small values are sensitive","title":"Small Count Rounding of Tabular Data","text":"main function, PLSrounding(), performs small count rounding necessary inner cells (Heldal, 2017) small frequencies cross-classifications published (publishable cells) rounded. equivalent changing micro data since frequencies unique combinations changed. Thus, additivity consistency guaranteed. performed algorithm inspired partial least squares regression (Langsrud Heldal, 2018).","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/index.html","id":"references","dir":"","previous_headings":"Small Count Rounding of Tabular Data > A statistical disclosure control tool to protect frequency tables in cases where small values are sensitive","what":"References","title":"Small Count Rounding of Tabular Data","text":"Heldal, J.: European Census Hub 2011 Hypercubes - Norwegian SDC Experiences. : Work Session Statistical Data Confidentiality (2017), Skopje, former Yugoslav Republic Macedonia, September 20-22 , 2017. Langsrud, Ø. Heldal, J.: Algorithm Small Count Rounding Tabular Data. presented : Privacy statistical databases, Valencia, Spain. September 26-28, 2018. Full-text presentation available Researchgate. 📌 See broader list available functions. Official version CRAN: https://cran.r-project.org/package=SmallCountRounding","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/FindMaxDiff.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate maxdiff nMaxdiff — FindMaxDiff","title":"Calculate maxdiff nMaxdiff — FindMaxDiff","text":"Calculate maxdiff  nMaxdiff","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/FindMaxDiff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate maxdiff nMaxdiff — FindMaxDiff","text":"","code":"FindMaxDiff(data, control, original, rounded, datareturn = FALSE)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/FindMaxDiff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate maxdiff nMaxdiff — FindMaxDiff","text":"data data control control original original rounded rounded datareturn datareturn","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/FindMaxDiff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate maxdiff nMaxdiff — FindMaxDiff","text":"maxdiff nMaxdiff","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/FormulaSelection.PLSrounded.html","id":null,"dir":"Reference","previous_headings":"","what":"FormulaSelection method for PLSrounded — FormulaSelection.PLSrounded","title":"FormulaSelection method for PLSrounded — FormulaSelection.PLSrounded","text":"FormulaSelection  method PLSrounded","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/FormulaSelection.PLSrounded.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FormulaSelection method for PLSrounded — FormulaSelection.PLSrounded","text":"","code":"# S3 method for class 'PLSrounded' FormulaSelection(x, formula = NULL, intercept = NA, logical = FALSE)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/FormulaSelection.PLSrounded.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"FormulaSelection method for PLSrounded — FormulaSelection.PLSrounded","text":"x PLSrounded object formula formula parameter FormulaSelection. NULL (default), publish data frame returned without limitation. intercept intercept parameter FormulaSelection. logical logical parameter FormulaSelection.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/FormulaSelection.PLSrounded.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"FormulaSelection method for PLSrounded — FormulaSelection.PLSrounded","text":"Limited version publish data frame","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/HDutility.html","id":null,"dir":"Reference","previous_headings":"","what":"Hellinger Distance (Utility) — HD","title":"Hellinger Distance (Utility) — HD","text":"Hellinger distance (HD) related utility measure (HDutility) described reference . utility measure made bounded 0 1.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/HDutility.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hellinger Distance (Utility) — HD","text":"","code":"HD(f, g)  HDutility(f, g)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/HDutility.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hellinger Distance (Utility) — HD","text":"f Vector original counts g Vector perturbed counts","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/HDutility.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hellinger Distance (Utility) — HD","text":"Hellinger distance related utility measure","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/HDutility.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hellinger Distance (Utility) — HD","text":"HD defined \"sqrt(sum((sqrt(f) - sqrt(g))^2)/2)\" HDutility  defined \"1 - HD(f, g)/sqrt(sum(f))\".","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/HDutility.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hellinger Distance (Utility) — HD","text":"Shlomo, N., Antal, L., & Elliot, M. (2015). Measuring Disclosure Risk Data Utility Flexible Table Generators, Journal Official Statistics, 31(2), 305-324. doi:10.1515/jos-2015-0019","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/HDutility.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hellinger Distance (Utility) — HD","text":"","code":"f <- 1:6 g <- c(0, 3, 3, 3, 6, 6) print(c(   HD = HD(f, g),    HDutility = HDutility(f, g),    maxdiff = max(abs(g - f)),    meanAbsDiff = mean(abs(g - f)),    rootMeanSquare = sqrt(mean((g - f)^2)) )) #>             HD      HDutility        maxdiff    meanAbsDiff rootMeanSquare  #>      0.7805018      0.8296805      1.0000000      0.6666667      0.8164966"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Lists2formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Make formula from input parameters to makeroundtabs() — Lists2formula","title":"Make formula from input parameters to makeroundtabs() — Lists2formula","text":"Make formula input parameters makeroundtabs()","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Lists2formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make formula from input parameters to makeroundtabs() — Lists2formula","text":"","code":"Lists2formula(d, control = NULL, data = NULL)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Lists2formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make formula from input parameters to makeroundtabs() — Lists2formula","text":"d d control control data data","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Lists2formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make formula from input parameters to makeroundtabs() — Lists2formula","text":"formula string","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/MakeControl.html","id":null,"dir":"Reference","previous_headings":"","what":"Make suggested control - input to makeroundtabs() — MakeControl","title":"Make suggested control - input to makeroundtabs() — MakeControl","text":"Make suggested control - input makeroundtabs()","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/MakeControl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make suggested control - input to makeroundtabs() — MakeControl","text":"","code":"MakeControl(d, data, level = 2)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/MakeControl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make suggested control - input to makeroundtabs() — MakeControl","text":"d input makeroundtabs() data data.frame level Interaction level","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/MakeControl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make suggested control - input to makeroundtabs() — MakeControl","text":"list","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLS2way.html","id":null,"dir":"Reference","previous_headings":"","what":"Two-way table from PLSrounding output — PLS2way","title":"Two-way table from PLSrounding output — PLS2way","text":"Output PLSrounding presented two-way table(s) cases possible. requirement number main dimensional variables two.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLS2way.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Two-way table from PLSrounding output — PLS2way","text":"","code":"PLS2way(obj, variable = c(\"rounded\", \"original\", \"difference\", \"code\"))"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLS2way.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Two-way table from PLSrounding output — PLS2way","text":"obj Output object PLSrounding variable One \"rounded\" (default), \"original\", \"difference\" \"code\".","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLS2way.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Two-way table from PLSrounding output — PLS2way","text":"data frame","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLS2way.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Two-way table from PLSrounding output — PLS2way","text":"parameter \"variable\" \"code\", output coded  \"#\" (publish), \".\" (inner) \"&\" ().","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLS2way.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Two-way table from PLSrounding output — PLS2way","text":"","code":"# Making tables from PLSrounding examples  z <- SmallCountData(\"e6\") a <- PLSrounding(z, \"freq\", formula = ~eu * year + geo) PLS2way(a, \"original\") #>          X2018 X2019 Total #> Iceland      2     1     3 #> Portugal     3     5     8 #> Spain        7     6    13 #> EU          10    11    21 #> Total       12    12    24 #> nonEU        2     1     3 PLS2way(a, \"difference\") #>          X2018 X2019 Total #> Iceland      1    -1     0 #> Portugal     0     0     0 #> Spain        0     0     0 #> EU           0     0     0 #> Total        1    -1     0 #> nonEU        1    -1     0 PLS2way(a, \"code\") #>          X2018 X2019 Total #> Iceland      .     .     # #> Portugal     .     .     # #> Spain        .     .     # #> EU           #     #     # #> Total        #     #     # #> nonEU        #     #     # PLS2way(PLSrounding(z, \"freq\", formula = ~eu * year + geo * year), \"code\") #>          X2018 X2019 Total #> Iceland      &     &     # #> Portugal     &     &     # #> Spain        &     &     # #> EU           #     #     # #> Total        #     #     # #> nonEU        #     #     # eHrc2 <- list(geo = c(\"EU\", \"@Portugal\", \"@Spain\", \"Iceland\"), year = c(\"2018\", \"2019\")) PLS2way(PLSrounding(z, \"freq\", hierarchies = eHrc2)) #>          X2018 X2019 Total #> Iceland      3     0     3 #> Portugal     3     5     8 #> Spain        7     6    13 #> EU          10    11    21 #> Total       13    11    24"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSrounding.html","id":null,"dir":"Reference","previous_headings":"","what":"PLS inspired rounding — PLSrounding","title":"PLS inspired rounding — PLSrounding","text":"Small count rounding necessary inner cells performed small frequencies cross-classifications published (publishable cells) rounded. publishable cells can defined model formula, hierarchies automatically data.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSrounding.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PLS inspired rounding — PLSrounding","text":"","code":"PLSrounding(   data,   freqVar = NULL,   roundBase = 3,   hierarchies = NULL,   formula = NULL,   dimVar = NULL,   maxRound = roundBase - 1,   printInc = nrow(data) > 1000,   output = NULL,   extend0 = FALSE,   preAggregate = is.null(freqVar),   aggregatePackage = \"base\",   aggregateNA = TRUE,   aggregateBaseOrder = FALSE,   rowGroupsPackage = aggregatePackage,   ... )  PLSroundingInner(..., output = \"inner\")  PLSroundingPublish(..., output = \"publish\")"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSrounding.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PLS inspired rounding — PLSrounding","text":"data Input data (inner cells), typically data frame, tibble, data.table. data classic data frame, coerced one internally unless preAggregate TRUE aggregatePackage \"data.table\". freqVar Variable holding counts (inner cells frequencies).  NULL (default), microdata assumed. roundBase Rounding base hierarchies List hierarchies formula Model formula defining publishable cells dimVar main dimensional variables additional aggregating variables. parameter can  useful hierarchies formula unspecified. maxRound Inner cells contributing original publishable cells equal less maxRound rounded printInc Printing iteration information console TRUE output Possible non-NULL values \"input\", \"inner\" \"publish\". single data frame returned. extend0 extend0 set TRUE, data automatically extended. relevant zeroCandidates = TRUE (see RoundViaDummy). Additionally, extend0 can specified list, representing varGroups parameter Extend0 function. Can also set \"\" means input codes hierarchies considered addition data. preAggregate TRUE, data aggregated beforehand within function dimensional variables. aggregatePackage Package used preAggregate. Parameter pkg aggregate_by_pkg. aggregateNA Whether include NAs grouping variables preAggregate. Parameter include_na aggregate_by_pkg. aggregateBaseOrder Parameter base_order aggregate_by_pkg, used preAggregate. default set FALSE avoid unnecessary sorting operations. TRUE, attempt made return result data.table base R. guaranteed due potential variations sorting behavior across different systems. rowGroupsPackage Parameter pkg RowGroups. parameter input Formula2ModelMatrix via ModelMatrix. ... parameters sent RoundViaDummy","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSrounding.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PLS inspired rounding — PLSrounding","text":"Output four-element list class attribute \"PLSrounded\", ensures informative printing enables use FormulaSelection object. inner Data frame corresponding input data main dimensional variables cell frequencies (original, rounded, difference). publish Data frame publishable data main dimensional variables cell frequencies (original, rounded, difference). metrics named character vector various statistics calculated two output data frames (\"inner_\" used distinguish). See examples function HDutility. freqTable Matrix frequencies cell frequencies absolute differences. example, row \"rounded\" column \"inn.4+\" number rounded inner cell frequencies greater equal 4.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSrounding.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"PLS inspired rounding — PLSrounding","text":"function user-friendly wrapper RoundViaDummy data frame output computed summary results. See RoundViaDummy details.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSrounding.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"PLS inspired rounding — PLSrounding","text":"Langsrud, Ø. Heldal, J. (2018): “Algorithm Small Count Rounding Tabular Data”. Presented : Privacy statistical databases, Valencia, Spain. September 26-28, 2018. https://www.researchgate.net/publication/327768398_An_Algorithm_for_Small_Count_Rounding_of_Tabular_Data","code":""},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSrounding.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PLS inspired rounding — PLSrounding","text":"","code":"# Small example data set z <- SmallCountData(\"e6\") print(z) #>        geo    eu year freq #> 1  Iceland nonEU 2018    2 #> 2 Portugal    EU 2018    3 #> 3    Spain    EU 2018    7 #> 4  Iceland nonEU 2019    1 #> 5 Portugal    EU 2019    5 #> 6    Spain    EU 2019    6  # Publishable cells by formula interface a <- PLSrounding(z, \"freq\", roundBase = 5,  formula = ~geo + eu + year) print(a) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              3          0.938           1.25         1.6583  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-4 inn.5 inn.6+ inn.all pub.0 pub.1-4 pub.5 pub.6+ pub.all #> original     .       3     1      2       6     .       2     .      6       8 #> rounded      1       1     2      2       6     .       .     2      6       8 #> absDiff      4       2     .      .       6     3       5     .      .       8 #>  print(a$inner) #>        geo year original rounded difference #> 1  Iceland 2018        2       5          3 #> 2 Portugal 2018        3       3          0 #> 3    Spain 2018        7       7          0 #> 4  Iceland 2019        1       0         -1 #> 5 Portugal 2019        5       5          0 #> 6    Spain 2019        6       6          0 print(a$publish) #>        geo  year original rounded difference #> 1    Total Total       24      26          2 #> 2  Iceland Total        3       5          2 #> 3 Portugal Total        8       8          0 #> 4    Spain Total       13      13          0 #> 5       EU Total       21      21          0 #> 6    nonEU Total        3       5          2 #> 7    Total  2018       12      15          3 #> 8    Total  2019       12      11         -1 print(a$metrics) #>            roundBase             maxRound              maxdiff  #>            5.0000000            4.0000000            3.0000000  #>      inner_HDutility            HDutility    inner_meanAbsDiff  #>            0.8131709            0.9380433            0.6666667  #>          meanAbsDiff inner_rootMeanSquare       rootMeanSquare  #>            1.2500000            1.2909944            1.6583124  print(a$freqTable) #>          inn.0 inn.1-4 inn.5 inn.6+ inn.all pub.0 pub.1-4 pub.5 pub.6+ pub.all #> original     0       3     1      2       6     0       2     0      6       8 #> rounded      1       1     2      2       6     0       0     2      6       8 #> absDiff      4       2     0      0       6     3       5     0      0       8  # Using FormulaSelection() FormulaSelection(a$publish, ~eu + year) #>     geo  year original rounded difference #> 1 Total Total       24      26          2 #> 5    EU Total       21      21          0 #> 6 nonEU Total        3       5          2 #> 7 Total  2018       12      15          3 #> 8 Total  2019       12      11         -1 FormulaSelection(a, ~eu + year) # same as above #>     geo  year original rounded difference #> 1 Total Total       24      26          2 #> 5    EU Total       21      21          0 #> 6 nonEU Total        3       5          2 #> 7 Total  2018       12      15          3 #> 8 Total  2019       12      11         -1 FormulaSelection(a)             # just a$publish #>        geo  year original rounded difference #> 1    Total Total       24      26          2 #> 2  Iceland Total        3       5          2 #> 3 Portugal Total        8       8          0 #> 4    Spain Total       13      13          0 #> 5       EU Total       21      21          0 #> 6    nonEU Total        3       5          2 #> 7    Total  2018       12      15          3 #> 8    Total  2019       12      11         -1  # Recalculation of maxdiff, HDutility, meanAbsDiff and rootMeanSquare max(abs(a$publish[, \"difference\"])) #> [1] 3 HDutility(a$publish[, \"original\"], a$publish[, \"rounded\"]) #> [1] 0.9380433 mean(abs(a$publish[, \"difference\"])) #> [1] 1.25 sqrt(mean((a$publish[, \"difference\"])^2)) #> [1] 1.658312  # Five lines below produce equivalent results  # Ordering of rows can be different PLSrounding(z, \"freq\", dimVar = c(\"geo\", \"eu\", \"year\")) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1         0.9117         0.3333         0.5774  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       4     3     11      18 #> rounded      1       .     2      3       6     2       .     5     11      18 #> absDiff      4       2     .      .       6    12       6     .      .      18 #>  PLSrounding(z, \"freq\", formula = ~eu * year + geo * year) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1         0.9117         0.3333         0.5774  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       4     3     11      18 #> rounded      1       .     2      3       6     2       .     5     11      18 #> absDiff      4       2     .      .       6    12       6     .      .      18 #>  PLSrounding(z[, -2], \"freq\", hierarchies = SmallCountData(\"eHrc\")) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1         0.9117         0.3333         0.5774  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       4     3     11      18 #> rounded      1       .     2      3       6     2       .     5     11      18 #> absDiff      4       2     .      .       6    12       6     .      .      18 #>  PLSrounding(z[, -2], \"freq\", hierarchies = SmallCountData(\"eDimList\")) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1         0.9117         0.3333         0.5774  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       4     3     11      18 #> rounded      1       .     2      3       6     2       .     5     11      18 #> absDiff      4       2     .      .       6    12       6     .      .      18 #>  PLSrounding(z[, -2], \"freq\", hierarchies = SmallCountData(\"eDimList\"), formula = ~geo * year) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1         0.9117         0.3333         0.5774  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       4     3     11      18 #> rounded      1       .     2      3       6     2       .     5     11      18 #> absDiff      4       2     .      .       6    12       6     .      .      18 #>   # Define publishable cells differently by making use of formula interface PLSrounding(z, \"freq\", formula = ~eu * year + geo) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1          0.931         0.3333         0.5774  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       2     2      8      12 #> rounded      1       .     2      3       6     1       .     3      8      12 #> absDiff      4       2     .      .       6     8       4     .      .      12 #>   # Define publishable cells differently by making use of hierarchy interface eHrc2 <- list(geo = c(\"EU\", \"@Portugal\", \"@Spain\", \"Iceland\"), year = c(\"2018\", \"2019\")) PLSrounding(z, \"freq\", hierarchies = eHrc2) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1         0.9357         0.2667         0.5164  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       2     2     11      15 #> rounded      1       .     2      3       6     1       .     3     11      15 #> absDiff      4       2     .      .       6    11       4     .      .      15 #>   # Also possible to combine hierarchies and formula PLSrounding(z, \"freq\", hierarchies = SmallCountData(\"eDimList\"), formula = ~geo + year) #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              0              1              0              0  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       .     2      7       9 #> rounded      .       2     1      3       6     .       .     2      7       9 #> absDiff      6       .     .      .       6     9       .     .      .       9 #>   # Single data frame output PLSroundingInner(z, \"freq\", roundBase = 5, formula = ~geo + eu + year) #>        geo year original rounded difference #> 1  Iceland 2018        2       5          3 #> 2 Portugal 2018        3       3          0 #> 3    Spain 2018        7       7          0 #> 4  Iceland 2019        1       0         -1 #> 5 Portugal 2019        5       5          0 #> 6    Spain 2019        6       6          0 PLSroundingPublish(z, roundBase = 5, formula = ~geo + eu + year) #>        geo  year original rounded difference #> 1    Total Total        6       5         -1 #> 2  Iceland Total        2       0         -2 #> 3 Portugal Total        2       0         -2 #> 4    Spain Total        2       5          3 #> 5       EU Total        4       5          1 #> 6    nonEU Total        2       0         -2 #> 7    Total  2018        3       5          2 #> 8    Total  2019        3       0         -3  # Microdata input PLSroundingInner(rbind(z, z), roundBase = 5, formula = ~geo + eu + year) #>        geo year original rounded difference #> 1 Portugal 2018        2       0         -2 #> 2    Spain 2018        2       5          3 #> 3  Iceland 2018        2       0         -2 #> 4 Portugal 2019        2       0         -2 #> 5    Spain 2019        2       0         -2 #> 6  Iceland 2019        2       5          3  # Zero perturbed due to both  extend0 = TRUE and zeroCandidates = TRUE  set.seed(12345) PLSroundingInner(z[sample.int(5, 12, replace = TRUE), 1:3],                   formula = ~geo + eu + year, roundBase = 5,                   extend0 = TRUE, zeroCandidates = TRUE, printInc = TRUE) #> [preAggregate 12*3->5*4] #> [extend0 5*4->6*4] #> [-**..:=] #>        geo year original rounded difference #> 1 Portugal 2018        4       0         -4 #> 2    Spain 2018        3       0         -3 #> 3  Iceland 2018        2       5          3 #> 4 Portugal 2019        1       0         -1 #> 5  Iceland 2019        2       0         -2 #> 6    Spain 2019        0       5          5  # Parameter avoidHierarchical (see RoundViaDummy and ModelMatrix)  PLSroundingPublish(z, roundBase = 5, formula = ~geo + eu + year, avoidHierarchical = TRUE) #>        geo    eu  year original rounded difference #> 1    Total Total Total        6       5         -1 #> 2  Iceland Total Total        2       0         -2 #> 3 Portugal Total Total        2       0         -2 #> 4    Spain Total Total        2       5          3 #> 5    Total    EU Total        4       5          1 #> 6    Total nonEU Total        2       0         -2 #> 7    Total Total  2018        3       5          2 #> 8    Total Total  2019        3       0         -3   # To illustrate hierarchical_extend0  #    (parameter to underlying function, SSBtools::Extend0fromModelMatrixInput) PLSroundingInner(z[-c(2:3), ], roundBase = 5, formula = ~geo + eu + year,     avoidHierarchical = TRUE, zeroCandidates = TRUE, extend0 = TRUE) #>         geo    eu year original rounded difference #> 1   Iceland nonEU 2018        1       0         -1 #> 2  Portugal    EU 2019        1       0         -1 #> 3     Spain    EU 2019        1       0         -1 #> 4   Iceland nonEU 2019        1       0         -1 #> 5  Portugal nonEU 2018        0       0          0 #> 6     Spain nonEU 2018        0       0          0 #> 7   Iceland    EU 2018        0       0          0 #> 8  Portugal    EU 2018        0       0          0 #> 9     Spain    EU 2018        0       0          0 #> 10 Portugal nonEU 2019        0       0          0 #> 11    Spain nonEU 2019        0       0          0 #> 12  Iceland    EU 2019        0       5          5 PLSroundingInner(z[-c(2:3), ], roundBase = 5, formula = ~geo + eu + year,     avoidHierarchical = TRUE, zeroCandidates = TRUE, extend0 = TRUE,     hierarchical_extend0 = TRUE) #>        geo    eu year original rounded difference #> 1  Iceland nonEU 2018        1       0         -1 #> 2 Portugal    EU 2019        1       0         -1 #> 3    Spain    EU 2019        1       0         -1 #> 4  Iceland nonEU 2019        1       5          4 #> 5 Portugal    EU 2018        0       0          0 #> 6    Spain    EU 2018        0       0          0  # Package sdcHierarchies can be used to create hierarchies.  # The small example code below works if this package is available.  if (require(sdcHierarchies)) {   z2 <- cbind(geo = c(\"11\", \"21\", \"22\"), z[, 3:4], stringsAsFactors = FALSE)   h2 <- list(     geo = hier_compute(inp = unique(z2$geo), dim_spec = c(1, 1), root = \"Tot\", as = \"df\"),     year = hier_convert(hier_create(root = \"Total\", nodes = c(\"2018\", \"2019\")), as = \"df\"))   PLSrounding(z2, \"freq\", hierarchies = h2) } #> Loading required package: sdcHierarchies #> Loading required package: shinythemes #> Package 'sdcHierarchies' 0.21.0 has been loaded. #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1         0.9117         0.3333         0.5774  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     .       2     1      3       6     .       4     3     11      18 #> rounded      1       .     2      3       6     2       .     5     11      18 #> absDiff      4       2     .      .       6    12       6     .      .      18 #>   # Use PLS2way to produce tables as in Langsrud and Heldal (2018) and to demonstrate  # parameters maxRound, zeroCandidates and identifyNew (see RoundViaDummy).    # Parameter rndSeed used to ensure same output as in reference. exPSD <- SmallCountData(\"exPSD\") a <- PLSrounding(exPSD, \"freq\", 5, formula = ~rows + cols, rndSeed=124) PLS2way(a, \"original\")  # Table 1 #>       col1 col2 col3 col4 col5 Total #> row1     6    0    1    3    4    14 #> row2     1    2    3    1    2     9 #> row3     0    1    1    0    2     4 #> Total    7    3    5    4    8    27 PLS2way(a)  # Table 2 #>       col1 col2 col3 col4 col5 Total #> row1     6    0    5    0    4    15 #> row2     1    0    0    5    2     8 #> row3     0    5    0    0    0     5 #> Total    7    5    5    5    6    28 a <- PLSrounding(exPSD, \"freq\", 5, formula = ~rows + cols, identifyNew = FALSE, rndSeed=124) PLS2way(a)  # Table 3 #>       col1 col2 col3 col4 col5 Total #> row1     6    0    1    0    4    11 #> row2     1    0    3    5    2    11 #> row3     0    5    0    0    0     5 #> Total    7    5    4    5    6    27 a <- PLSrounding(exPSD, \"freq\", 5, formula = ~rows + cols, maxRound = 7) PLS2way(a)  # Values in col1 rounded #>       col1 col2 col3 col4 col5 Total #> row1     5    0    0    5    0    10 #> row2     0    0    5    0    5    10 #> row3     0    5    0    0    0     5 #> Total    5    5    5    5    5    25 a <- PLSrounding(exPSD, \"freq\", 5, formula = ~rows + cols, zeroCandidates = TRUE) PLS2way(a)  # (row3, col4): original is 0 and rounded is 5 #>       col1 col2 col3 col4 col5 Total #> row1     6    0    5    0    4    15 #> row2     1    5    0    0    2     8 #> row3     0    0    0    5    0     5 #> Total    7    5    5    5    6    28  # Using formula followed by FormulaSelection  output <- PLSrounding(data = SmallCountData(\"example1\"),                        formula = ~age * geo * year + eu * year,                        freqVar = \"freq\",                        roundBase = 5) FormulaSelection(output, ~(age + eu) * year) #>      age   geo  year original rounded difference #> 1  Total Total Total       59      59          0 #> 2    old Total Total       38      37         -1 #> 3  young Total Total       21      22          1 #> 7  Total Total  2014       20      21          1 #> 8  Total Total  2015       18      16         -2 #> 9  Total Total  2016       21      22          1 #> 10 Total    EU Total       46      49          3 #> 11 Total nonEU Total       13      10         -3 #> 18   old Total  2014       13      16          3 #> 19   old Total  2015       13      11         -2 #> 20   old Total  2016       12      10         -2 #> 21 young Total  2014        7       5         -2 #> 22 young Total  2015        5       5          0 #> 23 young Total  2016        9      12          3 #> 33 Total    EU  2014       15      16          1 #> 34 Total nonEU  2014        5       5          0 #> 35 Total    EU  2015       15      16          1 #> 36 Total nonEU  2015        3       0         -3 #> 37 Total    EU  2016       16      17          1 #> 38 Total nonEU  2016        5       5          0  # Example similar to the one in the documentation of tables_by_formulas, # but using PLSroundingPublish with roundBase = 4. tables_by_formulas(SSBtoolsData(\"magnitude1\"),                    table_fun = PLSroundingPublish,                     table_formulas = list(table_1 = ~region * sector2,                                           table_2 = ~region1:sector4 - 1,                                           table_3 = ~region + sector4 - 1),                     substitute_vars = list(region = c(\"geo\", \"eu\"), region1 = \"eu\"),                     collapse_vars = list(sector = c(\"sector2\", \"sector4\")),                     roundBase = 4)  #>      region        sector original rounded difference table_1 table_2 table_3 #> 1     Total         Total       20      21          1    TRUE   FALSE   FALSE #> 2   Iceland         Total        4       4          0    TRUE   FALSE    TRUE #> 3  Portugal         Total        8       8          0    TRUE   FALSE    TRUE #> 4     Spain         Total        8       9          1    TRUE   FALSE    TRUE #> 5        EU         Total       16      17          1    TRUE   FALSE    TRUE #> 6     nonEU         Total        4       4          0    TRUE   FALSE    TRUE #> 7     Total       private       16      17          1    TRUE   FALSE   FALSE #> 8     Total        public        4       4          0    TRUE   FALSE   FALSE #> 9     Total   Agriculture        4       4          0   FALSE   FALSE    TRUE #> 10    Total Entertainment        6       5         -1   FALSE   FALSE    TRUE #> 11    Total  Governmental        4       4          0   FALSE   FALSE    TRUE #> 12    Total      Industry        6       8          2   FALSE   FALSE    TRUE #> 13  Iceland       private        4       4          0    TRUE   FALSE   FALSE #> 14 Portugal       private        6       4         -2    TRUE   FALSE   FALSE #> 15 Portugal        public        2       4          2    TRUE   FALSE   FALSE #> 16    Spain       private        6       9          3    TRUE   FALSE   FALSE #> 17    Spain        public        2       0         -2    TRUE   FALSE   FALSE #> 18       EU       private       12      13          1    TRUE   FALSE   FALSE #> 19       EU        public        4       4          0    TRUE   FALSE   FALSE #> 20    nonEU       private        4       4          0    TRUE   FALSE   FALSE #> 21       EU   Agriculture        4       4          0   FALSE    TRUE   FALSE #> 22       EU Entertainment        5       5          0   FALSE    TRUE   FALSE #> 23       EU  Governmental        4       4          0   FALSE    TRUE   FALSE #> 24       EU      Industry        3       4          1   FALSE    TRUE   FALSE #> 25    nonEU Entertainment        1       0         -1   FALSE    TRUE   FALSE #> 26    nonEU      Industry        3       4          1   FALSE    TRUE   FALSE"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingFits.html","id":null,"dir":"Reference","previous_headings":"","what":"Small count rounding with post-processing to expected frequencies — PLSroundingFits","title":"Small count rounding with post-processing to expected frequencies — PLSroundingFits","text":"counts rounded PLSrounding Thereafter, based publishable rounded data, expected inner cell frequencies generated iterative proportional fitting using Mipf. ensure empty cells missing input data included fitting process, data first extended using Extend0.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingFits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Small count rounding with post-processing to expected frequencies — PLSroundingFits","text":"","code":"PLSroundingFits(   data,   freqVar = NULL,   roundBase = 3,   hierarchies = NULL,   formula = NULL,   dimVar = NULL,   preAggregate = is.null(freqVar),   printInc = nrow(data) > 1000,   xReturn = FALSE,   extend0 = FALSE,   extend0Fits = TRUE,   limit = 1e-10,   viaQR = FALSE,   iter = 1000,   eps = 0.01,   tol = 1e-13,   reduceBy0 = TRUE,   reduceByColSums = TRUE,   reduceByLeverage = FALSE,   ... )"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingFits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Small count rounding with post-processing to expected frequencies — PLSroundingFits","text":"data data frame (inner cells) freqVar Variable holding counts roundBase Rounding base hierarchies List hierarchies formula Model formula dimVar Dimensional variables preAggregate Aggregation printInc Printing iteration information xReturn Dummy matrix output TRUE. return crossTable well, use xReturn = 2. extend0 PLSrounding parameter. See . extend0Fits extend0Fits set TRUE (default), data automatically extended. Additionally, extend0Fits can specified list, set \"\" (see PLSrounding). Previously, functionality controlled parameter called extend0, now extend0 specific PLSrounding function. extend0 extend0Fits used simultaneously, extend0Fits adds additional extension top one provided extend0 (see example). limit LSfitNonNeg parameter viaQR LSfitNonNeg parameter iter Mipf parameter eps Mipf parameter tol Mipf parameter reduceBy0 Mipf parameter reduceByColSums Mipf parameter reduceByLeverage Mipf parameter ... parameters PLSrounding.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingFits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Small count rounding with post-processing to expected frequencies — PLSroundingFits","text":"Output PLSrounding (class attribute \"PLSrounded\") modified versions inner publish: inner Extended input data variables expected frequencies (ipFit). publish Extended aggregated expected frequencies (ipFit).","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingFits.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Small count rounding with post-processing to expected frequencies — PLSroundingFits","text":"nine first parameters documented detail PLSrounding. iterative proportional fitting succeeds, maximum difference rounded counts ipFit less input parameter eps.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingFits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Small count rounding with post-processing to expected frequencies — PLSroundingFits","text":"","code":"z <- data.frame(geo  = c(\"Iceland\", \"Portugal\", \"Spain\"),                  eu = c(\"nonEU\", \"EU\", \"EU\"),                 year = rep(c(\"2018\",\"2019\"), each = 3),                 freq = c(2,3,7,1,5,6), stringsAsFactors = FALSE) z4 <- z[-c(1:2), ]  PLSroundingFits(z4, \"freq\", formula = ~eu * year + geo, extend0 = FALSE)[c(\"inner\", \"publish\")] #> -z(6*12->4*8):.  1 iterations: deviation 0 #> $inner #>        geo    eu year freq original rounded difference    ipFit #> 1    Spain    EU 2018    7        7       7          0 5.055556 #> 2  Iceland nonEU 2019    1        1       0         -1 0.000000 #> 3 Portugal    EU 2019    5        5       5          0 3.055556 #> 4    Spain    EU 2019    6        6       6          0 7.944444 #> 5  Iceland nonEU 2018    0        0       0          0 0.000000 #> 6 Portugal    EU 2018    0        0       0          0 1.944444 #>  #> $publish #>         geo  year original rounded difference ipFit #> 1     Total Total       19      18         -1    18 #> 2        EU Total       18      18          0    18 #> 3     nonEU Total        1       0         -1     0 #> 4     Total  2018        7       7          0     7 #> 5     Total  2019       12      11         -1    11 #> 6   Iceland Total        1       0         -1     0 #> 7  Portugal Total        5       5          0     5 #> 8     Spain Total       13      13          0    13 #> 9        EU  2018        7       7          0     7 #> 10       EU  2019       11      11          0    11 #> 11    nonEU  2018        0       0          0     0 #> 12    nonEU  2019        1       0         -1     0 #>  PLSroundingFits(z4, \"freq\", formula = ~eu * year + geo)[c(\"inner\", \"publish\")] #> -z(6*12->4*8):.  1 iterations: deviation 0 #> $inner #>        geo    eu year freq original rounded difference    ipFit #> 1    Spain    EU 2018    7        7       7          0 5.055556 #> 2  Iceland nonEU 2019    1        1       0         -1 0.000000 #> 3 Portugal    EU 2019    5        5       5          0 3.055556 #> 4    Spain    EU 2019    6        6       6          0 7.944444 #> 5  Iceland nonEU 2018    0        0       0          0 0.000000 #> 6 Portugal    EU 2018    0        0       0          0 1.944444 #>  #> $publish #>         geo  year original rounded difference ipFit #> 1     Total Total       19      18         -1    18 #> 2        EU Total       18      18          0    18 #> 3     nonEU Total        1       0         -1     0 #> 4     Total  2018        7       7          0     7 #> 5     Total  2019       12      11         -1    11 #> 6   Iceland Total        1       0         -1     0 #> 7  Portugal Total        5       5          0     5 #> 8     Spain Total       13      13          0    13 #> 9        EU  2018        7       7          0     7 #> 10       EU  2019       11      11          0    11 #> 11    nonEU  2018        0       0          0     0 #> 12    nonEU  2019        1       0         -1     0 #>   my_km2 <- SSBtools::SSBtoolsData(\"my_km2\")  # Default automatic extension (extend0Fits = TRUE) PLSroundingFits(my_km2, \"freq\",         formula = ~(Sex + Age) * Municipality * Square1000m + Square250m)[c(\"inner\", \"publish\")] #> -z(60*59->33*50):.  1 iterations: deviation 2.842171e-14 #> $inner #>    Square1000m      Square250m Municipality         Age    Sex freq original #> 1        my_km         500_000         Oslo    15_to_65 female    3        3 #> 2        my_km         500_000         Oslo    15_to_65   male    2        2 #> 3        my_km         500_000         Oslo    under_15   male    1        1 #> 4        my_km         750_250     Nittedal    15_to_65 female    2        2 #> 5        my_km         750_250     Nittedal    15_to_65   male    2        2 #> 6        my_km         750_250     Nittedal    under_15 female    1        1 #> 7        my_km         750_250     Nittedal    under_15   male    1        1 #> 8        my_km         750_500     Nittedal 65_and_over female    1        1 #> 9        my_km         750_500     Nittedal 65_and_over   male    1        1 #> 10       my_km         750_500         Oslo    15_to_65 female    1        1 #> 11  another_km another_500_000         Oslo    15_to_65 female   26       26 #> 12  another_km another_500_000         Oslo    15_to_65   male   21       21 #> 13  another_km another_500_000         Oslo    under_15 female   31       31 #> 14  another_km another_500_000         Oslo    under_15   male   34       34 #> 15  another_km another_750_250         Oslo    15_to_65 female    2        2 #> 16  another_km another_750_250         Oslo    15_to_65   male    1        1 #> 17  another_km another_750_250         Oslo 65_and_over female   10       10 #> 18  another_km another_750_250         Oslo 65_and_over   male   13       13 #> 19       my_km         500_000         Oslo    under_15 female    0        0 #> 20       my_km         500_000         Oslo 65_and_over female    0        0 #> 21       my_km         500_000         Oslo 65_and_over   male    0        0 #> 22       my_km         500_000     Nittedal    15_to_65 female    0        0 #> 23       my_km         500_000     Nittedal    15_to_65   male    0        0 #> 24       my_km         500_000     Nittedal    under_15 female    0        0 #> 25       my_km         500_000     Nittedal    under_15   male    0        0 #> 26       my_km         500_000     Nittedal 65_and_over female    0        0 #> 27       my_km         500_000     Nittedal 65_and_over   male    0        0 #> 28       my_km         750_250         Oslo    15_to_65 female    0        0 #> 29       my_km         750_250         Oslo    15_to_65   male    0        0 #> 30       my_km         750_250         Oslo    under_15 female    0        0 #> 31       my_km         750_250         Oslo    under_15   male    0        0 #> 32       my_km         750_250         Oslo 65_and_over female    0        0 #> 33       my_km         750_250         Oslo 65_and_over   male    0        0 #> 34       my_km         750_250     Nittedal 65_and_over female    0        0 #> 35       my_km         750_250     Nittedal 65_and_over   male    0        0 #> 36       my_km         750_500         Oslo    15_to_65   male    0        0 #> 37       my_km         750_500         Oslo    under_15 female    0        0 #> 38       my_km         750_500         Oslo    under_15   male    0        0 #> 39       my_km         750_500         Oslo 65_and_over female    0        0 #> 40       my_km         750_500         Oslo 65_and_over   male    0        0 #> 41       my_km         750_500     Nittedal    15_to_65 female    0        0 #> 42       my_km         750_500     Nittedal    15_to_65   male    0        0 #> 43       my_km         750_500     Nittedal    under_15 female    0        0 #> 44       my_km         750_500     Nittedal    under_15   male    0        0 #> 45  another_km another_500_000         Oslo 65_and_over female    0        0 #> 46  another_km another_500_000         Oslo 65_and_over   male    0        0 #> 47  another_km another_500_000     Nittedal    15_to_65 female    0        0 #> 48  another_km another_500_000     Nittedal    15_to_65   male    0        0 #> 49  another_km another_500_000     Nittedal    under_15 female    0        0 #> 50  another_km another_500_000     Nittedal    under_15   male    0        0 #> 51  another_km another_500_000     Nittedal 65_and_over female    0        0 #> 52  another_km another_500_000     Nittedal 65_and_over   male    0        0 #> 53  another_km another_750_250         Oslo    under_15 female    0        0 #> 54  another_km another_750_250         Oslo    under_15   male    0        0 #> 55  another_km another_750_250     Nittedal    15_to_65 female    0        0 #> 56  another_km another_750_250     Nittedal    15_to_65   male    0        0 #> 57  another_km another_750_250     Nittedal    under_15 female    0        0 #> 58  another_km another_750_250     Nittedal    under_15   male    0        0 #> 59  another_km another_750_250     Nittedal 65_and_over female    0        0 #> 60  another_km another_750_250     Nittedal 65_and_over   male    0        0 #>    rounded difference     ipFit #> 1        3          0  1.125000 #> 2        0         -2  0.000000 #> 3        0         -1  0.000000 #> 4        2          0  0.875000 #> 5        2          0  0.875000 #> 6        0         -1  0.656250 #> 7        3          2  0.656250 #> 8        3          2  0.562500 #> 9        0         -1  0.562500 #> 10       3          2  2.250000 #> 11      26          0 20.289855 #> 12      21          0 20.289855 #> 13      31          0 26.376812 #> 14      34          0 26.376812 #> 15       2          0  4.710145 #> 16       1          0  4.710145 #> 17      10          0  2.166667 #> 18      13          0  2.166667 #> 19       0          0  0.000000 #> 20       0          0  0.000000 #> 21       0          0  0.000000 #> 22       0          0  0.375000 #> 23       0          0  0.375000 #> 24       0          0  0.281250 #> 25       0          0  0.281250 #> 26       0          0  0.281250 #> 27       0          0  0.281250 #> 28       0          0  2.625000 #> 29       0          0  0.000000 #> 30       0          0  0.000000 #> 31       0          0  0.000000 #> 32       0          0  0.000000 #> 33       0          0  0.000000 #> 34       0          0  0.656250 #> 35       0          0  0.656250 #> 36       0          0  0.000000 #> 37       0          0  0.000000 #> 38       0          0  0.000000 #> 39       0          0  0.000000 #> 40       0          0  0.000000 #> 41       0          0  0.750000 #> 42       0          0  0.750000 #> 43       0          0  0.562500 #> 44       0          0  0.562500 #> 45       0          0  9.333333 #> 46       0          0  9.333333 #> 47       0          0  0.000000 #> 48       0          0  0.000000 #> 49       0          0  0.000000 #> 50       0          0  0.000000 #> 51       0          0  0.000000 #> 52       0          0  0.000000 #> 53       0          0  6.123188 #> 54       0          0  6.123188 #> 55       0          0  0.000000 #> 56       0          0  0.000000 #> 57       0          0  0.000000 #> 58       0          0  0.000000 #> 59       0          0  0.000000 #> 60       0          0  0.000000 #>  #> $publish #>         Square250m Municipality         Age    Sex original rounded difference #> 1            Total        Total       Total  Total      153     154          1 #> 2            Total        Total       Total female       77      80          3 #> 3            Total        Total       Total   male       76      74         -2 #> 4            Total        Total    15_to_65  Total       60      60          0 #> 5            Total        Total 65_and_over  Total       25      26          1 #> 6            Total        Total    under_15  Total       68      68          0 #> 7            Total     Nittedal       Total  Total        8      10          2 #> 8            Total         Oslo       Total  Total      145     144         -1 #> 9       another_km        Total       Total  Total      138     138          0 #> 10           my_km        Total       Total  Total       15      16          1 #> 11         500_000        Total       Total  Total        6       3         -3 #> 12         750_250        Total       Total  Total        6       7          1 #> 13         750_500        Total       Total  Total        3       6          3 #> 14 another_500_000        Total       Total  Total      112     112          0 #> 15 another_750_250        Total       Total  Total       26      26          0 #> 16           Total     Nittedal       Total female        4       5          1 #> 17           Total         Oslo       Total female       73      75          2 #> 18           Total     Nittedal       Total   male        4       5          1 #> 19           Total         Oslo       Total   male       72      69         -3 #> 20           Total     Nittedal    15_to_65  Total        4       4          0 #> 21           Total         Oslo    15_to_65  Total       56      56          0 #> 22           Total     Nittedal 65_and_over  Total        2       3          1 #> 23           Total         Oslo 65_and_over  Total       23      23          0 #> 24           Total     Nittedal    under_15  Total        2       3          1 #> 25           Total         Oslo    under_15  Total       66      65         -1 #> 26      another_km        Total       Total female       69      69          0 #> 27           my_km        Total       Total female        8      11          3 #> 28      another_km        Total       Total   male       69      69          0 #> 29           my_km        Total       Total   male        7       5         -2 #> 30      another_km        Total    15_to_65  Total       50      50          0 #> 31           my_km        Total    15_to_65  Total       10      10          0 #> 32      another_km        Total 65_and_over  Total       23      23          0 #> 33           my_km        Total 65_and_over  Total        2       3          1 #> 34      another_km        Total    under_15  Total       65      65          0 #> 35           my_km        Total    under_15  Total        3       3          0 #> 36      another_km     Nittedal       Total  Total        0       0          0 #> 37           my_km     Nittedal       Total  Total        8      10          2 #> 38      another_km         Oslo       Total  Total      138     138          0 #> 39           my_km         Oslo       Total  Total        7       6         -1 #> 40      another_km     Nittedal       Total female        0       0          0 #> 41           my_km     Nittedal       Total female        4       5          1 #> 42      another_km         Oslo       Total female       69      69          0 #> 43           my_km         Oslo       Total female        4       6          2 #> 44      another_km     Nittedal       Total   male        0       0          0 #> 45           my_km     Nittedal       Total   male        4       5          1 #> 46      another_km         Oslo       Total   male       69      69          0 #> 47           my_km         Oslo       Total   male        3       0         -3 #> 48      another_km     Nittedal    15_to_65  Total        0       0          0 #> 49           my_km     Nittedal    15_to_65  Total        4       4          0 #> 50      another_km         Oslo    15_to_65  Total       50      50          0 #> 51           my_km         Oslo    15_to_65  Total        6       6          0 #> 52      another_km     Nittedal 65_and_over  Total        0       0          0 #> 53           my_km     Nittedal 65_and_over  Total        2       3          1 #> 54      another_km         Oslo 65_and_over  Total       23      23          0 #> 55           my_km         Oslo 65_and_over  Total        0       0          0 #> 56      another_km     Nittedal    under_15  Total        0       0          0 #> 57           my_km     Nittedal    under_15  Total        2       3          1 #> 58      another_km         Oslo    under_15  Total       65      65          0 #> 59           my_km         Oslo    under_15  Total        1       0         -1 #>    ipFit #> 1    154 #> 2     80 #> 3     74 #> 4     60 #> 5     26 #> 6     68 #> 7     10 #> 8    144 #> 9    138 #> 10    16 #> 11     3 #> 12     7 #> 13     6 #> 14   112 #> 15    26 #> 16     5 #> 17    75 #> 18     5 #> 19    69 #> 20     4 #> 21    56 #> 22     3 #> 23    23 #> 24     3 #> 25    65 #> 26    69 #> 27    11 #> 28    69 #> 29     5 #> 30    50 #> 31    10 #> 32    23 #> 33     3 #> 34    65 #> 35     3 #> 36     0 #> 37    10 #> 38   138 #> 39     6 #> 40     0 #> 41     5 #> 42    69 #> 43     6 #> 44     0 #> 45     5 #> 46    69 #> 47     0 #> 48     0 #> 49     4 #> 50    50 #> 51     6 #> 52     0 #> 53     3 #> 54    23 #> 55     0 #> 56     0 #> 57     3 #> 58    65 #> 59     0 #>   # Manual specification to avoid Nittedal combined with another_km PLSroundingFits(my_km2, \"freq\", formula = ~(Sex + Age) * Municipality * Square1000m + Square250m,         extend0Fits = list(c(\"Sex\", \"Age\"),         c(\"Municipality\", \"Square1000m\", \"Square250m\")))[c(\"inner\", \"publish\")] #> -zx-x-(36*53->24*46):.  1 iterations: deviation 1.421085e-14 #> $inner #>    Square1000m      Square250m Municipality         Age    Sex freq original #> 1        my_km         500_000         Oslo    15_to_65 female    3        3 #> 2        my_km         500_000         Oslo    15_to_65   male    2        2 #> 3        my_km         500_000         Oslo    under_15   male    1        1 #> 4        my_km         750_250     Nittedal    15_to_65 female    2        2 #> 5        my_km         750_250     Nittedal    15_to_65   male    2        2 #> 6        my_km         750_250     Nittedal    under_15 female    1        1 #> 7        my_km         750_250     Nittedal    under_15   male    1        1 #> 8        my_km         750_500     Nittedal 65_and_over female    1        1 #> 9        my_km         750_500     Nittedal 65_and_over   male    1        1 #> 10       my_km         750_500         Oslo    15_to_65 female    1        1 #> 11  another_km another_500_000         Oslo    15_to_65 female   26       26 #> 12  another_km another_500_000         Oslo    15_to_65   male   21       21 #> 13  another_km another_500_000         Oslo    under_15 female   31       31 #> 14  another_km another_500_000         Oslo    under_15   male   34       34 #> 15  another_km another_750_250         Oslo    15_to_65 female    2        2 #> 16  another_km another_750_250         Oslo    15_to_65   male    1        1 #> 17  another_km another_750_250         Oslo 65_and_over female   10       10 #> 18  another_km another_750_250         Oslo 65_and_over   male   13       13 #> 19       my_km         500_000         Oslo    under_15 female    0        0 #> 20       my_km         500_000         Oslo 65_and_over female    0        0 #> 21       my_km         500_000         Oslo 65_and_over   male    0        0 #> 22       my_km         750_250     Nittedal 65_and_over female    0        0 #> 23       my_km         750_250     Nittedal 65_and_over   male    0        0 #> 24       my_km         750_500     Nittedal    15_to_65 female    0        0 #> 25       my_km         750_500     Nittedal    15_to_65   male    0        0 #> 26       my_km         750_500     Nittedal    under_15   male    0        0 #> 27       my_km         750_500     Nittedal    under_15 female    0        0 #> 28       my_km         750_500         Oslo    15_to_65   male    0        0 #> 29       my_km         750_500         Oslo    under_15   male    0        0 #> 30       my_km         750_500         Oslo    under_15 female    0        0 #> 31       my_km         750_500         Oslo 65_and_over female    0        0 #> 32       my_km         750_500         Oslo 65_and_over   male    0        0 #> 33  another_km another_500_000         Oslo 65_and_over female    0        0 #> 34  another_km another_500_000         Oslo 65_and_over   male    0        0 #> 35  another_km another_750_250         Oslo    under_15   male    0        0 #> 36  another_km another_750_250         Oslo    under_15 female    0        0 #>    rounded difference     ipFit #> 1        3          0  3.000000 #> 2        0         -2  0.000000 #> 3        0         -1  0.000000 #> 4        2          0  1.400000 #> 5        2          0  1.400000 #> 6        0         -1  1.050000 #> 7        3          2  1.050000 #> 8        3          2  0.450000 #> 9        0         -1  0.450000 #> 10       3          2  3.000000 #> 11      26          0 20.289855 #> 12      21          0 20.289855 #> 13      31          0 26.376812 #> 14      34          0 26.376812 #> 15       2          0  4.710145 #> 16       1          0  4.710145 #> 17      10          0  2.166667 #> 18      13          0  2.166667 #> 19       0          0  0.000000 #> 20       0          0  0.000000 #> 21       0          0  0.000000 #> 22       0          0  1.050000 #> 23       0          0  1.050000 #> 24       0          0  0.600000 #> 25       0          0  0.600000 #> 26       0          0  0.450000 #> 27       0          0  0.450000 #> 28       0          0  0.000000 #> 29       0          0  0.000000 #> 30       0          0  0.000000 #> 31       0          0  0.000000 #> 32       0          0  0.000000 #> 33       0          0  9.333333 #> 34       0          0  9.333333 #> 35       0          0  6.123188 #> 36       0          0  6.123188 #>  #> $publish #>         Square250m Municipality         Age    Sex original rounded difference #> 1            Total        Total       Total  Total      153     154          1 #> 2            Total        Total       Total female       77      80          3 #> 3            Total        Total       Total   male       76      74         -2 #> 4            Total        Total    15_to_65  Total       60      60          0 #> 5            Total        Total 65_and_over  Total       25      26          1 #> 6            Total        Total    under_15  Total       68      68          0 #> 7            Total     Nittedal       Total  Total        8      10          2 #> 8            Total         Oslo       Total  Total      145     144         -1 #> 9       another_km        Total       Total  Total      138     138          0 #> 10           my_km        Total       Total  Total       15      16          1 #> 11         500_000        Total       Total  Total        6       3         -3 #> 12         750_250        Total       Total  Total        6       7          1 #> 13         750_500        Total       Total  Total        3       6          3 #> 14 another_500_000        Total       Total  Total      112     112          0 #> 15 another_750_250        Total       Total  Total       26      26          0 #> 16           Total     Nittedal       Total female        4       5          1 #> 17           Total         Oslo       Total female       73      75          2 #> 18           Total     Nittedal       Total   male        4       5          1 #> 19           Total         Oslo       Total   male       72      69         -3 #> 20           Total     Nittedal    15_to_65  Total        4       4          0 #> 21           Total         Oslo    15_to_65  Total       56      56          0 #> 22           Total     Nittedal 65_and_over  Total        2       3          1 #> 23           Total         Oslo 65_and_over  Total       23      23          0 #> 24           Total     Nittedal    under_15  Total        2       3          1 #> 25           Total         Oslo    under_15  Total       66      65         -1 #> 26      another_km        Total       Total female       69      69          0 #> 27           my_km        Total       Total female        8      11          3 #> 28      another_km        Total       Total   male       69      69          0 #> 29           my_km        Total       Total   male        7       5         -2 #> 30      another_km        Total    15_to_65  Total       50      50          0 #> 31           my_km        Total    15_to_65  Total       10      10          0 #> 32      another_km        Total 65_and_over  Total       23      23          0 #> 33           my_km        Total 65_and_over  Total        2       3          1 #> 34      another_km        Total    under_15  Total       65      65          0 #> 35           my_km        Total    under_15  Total        3       3          0 #> 36           my_km     Nittedal       Total  Total        8      10          2 #> 37      another_km         Oslo       Total  Total      138     138          0 #> 38           my_km         Oslo       Total  Total        7       6         -1 #> 39           my_km     Nittedal       Total female        4       5          1 #> 40      another_km         Oslo       Total female       69      69          0 #> 41           my_km         Oslo       Total female        4       6          2 #> 42           my_km     Nittedal       Total   male        4       5          1 #> 43      another_km         Oslo       Total   male       69      69          0 #> 44           my_km         Oslo       Total   male        3       0         -3 #> 45           my_km     Nittedal    15_to_65  Total        4       4          0 #> 46      another_km         Oslo    15_to_65  Total       50      50          0 #> 47           my_km         Oslo    15_to_65  Total        6       6          0 #> 48           my_km     Nittedal 65_and_over  Total        2       3          1 #> 49      another_km         Oslo 65_and_over  Total       23      23          0 #> 50           my_km         Oslo 65_and_over  Total        0       0          0 #> 51           my_km     Nittedal    under_15  Total        2       3          1 #> 52      another_km         Oslo    under_15  Total       65      65          0 #> 53           my_km         Oslo    under_15  Total        1       0         -1 #>    ipFit #> 1    154 #> 2     80 #> 3     74 #> 4     60 #> 5     26 #> 6     68 #> 7     10 #> 8    144 #> 9    138 #> 10    16 #> 11     3 #> 12     7 #> 13     6 #> 14   112 #> 15    26 #> 16     5 #> 17    75 #> 18     5 #> 19    69 #> 20     4 #> 21    56 #> 22     3 #> 23    23 #> 24     3 #> 25    65 #> 26    69 #> 27    11 #> 28    69 #> 29     5 #> 30    50 #> 31    10 #> 32    23 #> 33     3 #> 34    65 #> 35     3 #> 36    10 #> 37   138 #> 38     6 #> 39     5 #> 40    69 #> 41     6 #> 42     5 #> 43    69 #> 44     0 #> 45     4 #> 46    50 #> 47     6 #> 48     3 #> 49    23 #> 50     0 #> 51     3 #> 52    65 #> 53     0 #>          # Example with both extend0 (specified) and extend0Fits (default is TRUE) PLSroundingFits(my_km2, \"freq\", formula = ~(Sex + Age) * Municipality * Square1000m + Square250m,         printInc = TRUE, zeroCandidates = TRUE, roundBase = 5, extend0 = list(c(\"Sex\", \"Age\"),         c(\"Municipality\", \"Square1000m\", \"Square250m\")))[c(\"inner\", \"publish\")]         #> [extend0 18*6->36*6] #> [extend0Fits 36*6->60*6] #> [-**...:=] #> -z(60*59->27*47):.  1 iterations: deviation 1.421085e-14 #> $inner #>       Sex         Age Municipality Square1000m      Square250m freq original #> 1  female    15_to_65         Oslo       my_km         500_000    3        3 #> 2    male    15_to_65         Oslo       my_km         500_000    2        2 #> 3    male    under_15         Oslo       my_km         500_000    1        1 #> 4  female    15_to_65     Nittedal       my_km         750_250    2        2 #> 5    male    15_to_65     Nittedal       my_km         750_250    2        2 #> 6  female    under_15     Nittedal       my_km         750_250    1        1 #> 7    male    under_15     Nittedal       my_km         750_250    1        1 #> 8  female 65_and_over     Nittedal       my_km         750_500    1        1 #> 9    male 65_and_over     Nittedal       my_km         750_500    1        1 #> 10 female    15_to_65         Oslo       my_km         750_500    1        1 #> 11 female    15_to_65         Oslo  another_km another_500_000   26       26 #> 12   male    15_to_65         Oslo  another_km another_500_000   21       21 #> 13 female    under_15         Oslo  another_km another_500_000   31       31 #> 14   male    under_15         Oslo  another_km another_500_000   34       34 #> 15 female    15_to_65         Oslo  another_km another_750_250    2        2 #> 16   male    15_to_65         Oslo  another_km another_750_250    1        1 #> 17 female 65_and_over         Oslo  another_km another_750_250   10       10 #> 18   male 65_and_over         Oslo  another_km another_750_250   13       13 #> 19 female    under_15         Oslo       my_km         500_000    0        0 #> 20 female 65_and_over         Oslo       my_km         500_000    0        0 #> 21   male 65_and_over         Oslo       my_km         500_000    0        0 #> 22 female 65_and_over     Nittedal       my_km         750_250    0        0 #> 23   male 65_and_over     Nittedal       my_km         750_250    0        0 #> 24 female    15_to_65     Nittedal       my_km         750_500    0        0 #> 25   male    15_to_65     Nittedal       my_km         750_500    0        0 #> 26   male    under_15     Nittedal       my_km         750_500    0        0 #> 27 female    under_15     Nittedal       my_km         750_500    0        0 #> 28   male    15_to_65         Oslo       my_km         750_500    0        0 #> 29   male    under_15         Oslo       my_km         750_500    0        0 #> 30 female    under_15         Oslo       my_km         750_500    0        0 #> 31 female 65_and_over         Oslo       my_km         750_500    0        0 #> 32   male 65_and_over         Oslo       my_km         750_500    0        0 #> 33 female 65_and_over         Oslo  another_km another_500_000    0        0 #> 34   male 65_and_over         Oslo  another_km another_500_000    0        0 #> 35   male    under_15         Oslo  another_km another_750_250    0        0 #> 36 female    under_15         Oslo  another_km another_750_250    0        0 #> 37 female    15_to_65     Nittedal       my_km         500_000    0        0 #> 38   male    15_to_65     Nittedal       my_km         500_000    0        0 #> 39 female    under_15     Nittedal       my_km         500_000    0        0 #> 40   male    under_15     Nittedal       my_km         500_000    0        0 #> 41 female 65_and_over     Nittedal       my_km         500_000    0        0 #> 42   male 65_and_over     Nittedal       my_km         500_000    0        0 #> 43 female    15_to_65         Oslo       my_km         750_250    0        0 #> 44   male    15_to_65         Oslo       my_km         750_250    0        0 #> 45 female    under_15         Oslo       my_km         750_250    0        0 #> 46   male    under_15         Oslo       my_km         750_250    0        0 #> 47 female 65_and_over         Oslo       my_km         750_250    0        0 #> 48   male 65_and_over         Oslo       my_km         750_250    0        0 #> 49 female    15_to_65     Nittedal  another_km another_500_000    0        0 #> 50   male    15_to_65     Nittedal  another_km another_500_000    0        0 #> 51 female    under_15     Nittedal  another_km another_500_000    0        0 #> 52   male    under_15     Nittedal  another_km another_500_000    0        0 #> 53 female 65_and_over     Nittedal  another_km another_500_000    0        0 #> 54   male 65_and_over     Nittedal  another_km another_500_000    0        0 #> 55 female    15_to_65     Nittedal  another_km another_750_250    0        0 #> 56   male    15_to_65     Nittedal  another_km another_750_250    0        0 #> 57 female    under_15     Nittedal  another_km another_750_250    0        0 #> 58   male    under_15     Nittedal  another_km another_750_250    0        0 #> 59 female 65_and_over     Nittedal  another_km another_750_250    0        0 #> 60   male 65_and_over     Nittedal  another_km another_750_250    0        0 #>    rounded difference      ipFit #> 1        5          2  1.6666667 #> 2        0         -2  0.0000000 #> 3        0         -1  0.0000000 #> 4        0         -2  0.8333333 #> 5        5          3  0.8333333 #> 6        0         -1  0.8333333 #> 7        0         -1  0.8333333 #> 8        0         -1  0.0000000 #> 9        0         -1  0.0000000 #> 10       0         -1  1.6666667 #> 11      26          0 20.2898551 #> 12      21          0 20.2898551 #> 13      31          0 26.3768116 #> 14      34          0 26.3768116 #> 15       2          0  4.7101449 #> 16       1          0  4.7101449 #> 17      10          0  2.1666667 #> 18      13          0  2.1666667 #> 19       0          0  0.0000000 #> 20       0          0  0.0000000 #> 21       0          0  0.0000000 #> 22       0          0  0.0000000 #> 23       0          0  0.0000000 #> 24       0          0  0.8333333 #> 25       0          0  0.8333333 #> 26       0          0  0.8333333 #> 27       5          5  0.8333333 #> 28       0          0  0.0000000 #> 29       0          0  0.0000000 #> 30       0          0  0.0000000 #> 31       0          0  0.0000000 #> 32       0          0  0.0000000 #> 33       0          0  9.3333333 #> 34       0          0  9.3333333 #> 35       0          0  6.1231884 #> 36       0          0  6.1231884 #> 37       0          0  0.8333333 #> 38       0          0  0.8333333 #> 39       0          0  0.8333333 #> 40       0          0  0.8333333 #> 41       0          0  0.0000000 #> 42       0          0  0.0000000 #> 43       0          0  1.6666667 #> 44       0          0  0.0000000 #> 45       0          0  0.0000000 #> 46       0          0  0.0000000 #> 47       0          0  0.0000000 #> 48       0          0  0.0000000 #> 49       0          0  0.0000000 #> 50       0          0  0.0000000 #> 51       0          0  0.0000000 #> 52       0          0  0.0000000 #> 53       0          0  0.0000000 #> 54       0          0  0.0000000 #> 55       0          0  0.0000000 #> 56       0          0  0.0000000 #> 57       0          0  0.0000000 #> 58       0          0  0.0000000 #> 59       0          0  0.0000000 #> 60       0          0  0.0000000 #>  #> $publish #>       Sex         Age Municipality      Square250m original rounded difference #> 1   Total       Total        Total           Total      153     153          0 #> 2  female       Total        Total           Total       77      79          2 #> 3    male       Total        Total           Total       76      74         -2 #> 4   Total    15_to_65        Total           Total       60      60          0 #> 5   Total 65_and_over        Total           Total       25      23         -2 #> 6   Total    under_15        Total           Total       68      70          2 #> 7   Total       Total     Nittedal           Total        8      10          2 #> 8   Total       Total         Oslo           Total      145     143         -2 #> 9   Total       Total        Total      another_km      138     138          0 #> 10  Total       Total        Total           my_km       15      15          0 #> 11  Total       Total        Total         500_000        6       5         -1 #> 12  Total       Total        Total         750_250        6       5         -1 #> 13  Total       Total        Total         750_500        3       5          2 #> 14  Total       Total        Total another_500_000      112     112          0 #> 15  Total       Total        Total another_750_250       26      26          0 #> 16 female       Total     Nittedal           Total        4       5          1 #> 17 female       Total         Oslo           Total       73      74          1 #> 18   male       Total     Nittedal           Total        4       5          1 #> 19   male       Total         Oslo           Total       72      69         -3 #> 20  Total    15_to_65     Nittedal           Total        4       5          1 #> 21  Total    15_to_65         Oslo           Total       56      55         -1 #> 22  Total 65_and_over     Nittedal           Total        2       0         -2 #> 23  Total 65_and_over         Oslo           Total       23      23          0 #> 24  Total    under_15     Nittedal           Total        2       5          3 #> 25  Total    under_15         Oslo           Total       66      65         -1 #> 26 female       Total        Total      another_km       69      69          0 #> 27 female       Total        Total           my_km        8      10          2 #> 28   male       Total        Total      another_km       69      69          0 #> 29   male       Total        Total           my_km        7       5         -2 #> 30  Total    15_to_65        Total      another_km       50      50          0 #> 31  Total    15_to_65        Total           my_km       10      10          0 #> 32  Total 65_and_over        Total      another_km       23      23          0 #> 33  Total 65_and_over        Total           my_km        2       0         -2 #> 34  Total    under_15        Total      another_km       65      65          0 #> 35  Total    under_15        Total           my_km        3       5          2 #> 36  Total       Total     Nittedal      another_km        0       0          0 #> 37  Total       Total     Nittedal           my_km        8      10          2 #> 38  Total       Total         Oslo      another_km      138     138          0 #> 39  Total       Total         Oslo           my_km        7       5         -2 #> 40 female       Total     Nittedal      another_km        0       0          0 #> 41 female       Total     Nittedal           my_km        4       5          1 #> 42 female       Total         Oslo      another_km       69      69          0 #> 43 female       Total         Oslo           my_km        4       5          1 #> 44   male       Total     Nittedal      another_km        0       0          0 #> 45   male       Total     Nittedal           my_km        4       5          1 #> 46   male       Total         Oslo      another_km       69      69          0 #> 47   male       Total         Oslo           my_km        3       0         -3 #> 48  Total    15_to_65     Nittedal      another_km        0       0          0 #> 49  Total    15_to_65     Nittedal           my_km        4       5          1 #> 50  Total    15_to_65         Oslo      another_km       50      50          0 #> 51  Total    15_to_65         Oslo           my_km        6       5         -1 #> 52  Total 65_and_over     Nittedal      another_km        0       0          0 #> 53  Total 65_and_over     Nittedal           my_km        2       0         -2 #> 54  Total 65_and_over         Oslo      another_km       23      23          0 #> 55  Total 65_and_over         Oslo           my_km        0       0          0 #> 56  Total    under_15     Nittedal      another_km        0       0          0 #> 57  Total    under_15     Nittedal           my_km        2       5          3 #> 58  Total    under_15         Oslo      another_km       65      65          0 #> 59  Total    under_15         Oslo           my_km        1       0         -1 #>    ipFit #> 1    153 #> 2     79 #> 3     74 #> 4     60 #> 5     23 #> 6     70 #> 7     10 #> 8    143 #> 9    138 #> 10    15 #> 11     5 #> 12     5 #> 13     5 #> 14   112 #> 15    26 #> 16     5 #> 17    74 #> 18     5 #> 19    69 #> 20     5 #> 21    55 #> 22     0 #> 23    23 #> 24     5 #> 25    65 #> 26    69 #> 27    10 #> 28    69 #> 29     5 #> 30    50 #> 31    10 #> 32    23 #> 33     0 #> 34    65 #> 35     5 #> 36     0 #> 37    10 #> 38   138 #> 39     5 #> 40     0 #> 41     5 #> 42    69 #> 43     5 #> 44     0 #> 45     5 #> 46    69 #> 47     0 #> 48     0 #> 49     5 #> 50    50 #> 51     5 #> 52     0 #> 53     0 #> 54    23 #> 55     0 #> 56     0 #> 57     5 #> 58    65 #> 59     0 #>"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingLoop.html","id":null,"dir":"Reference","previous_headings":"","what":"PLSrounding on portions of data at a time — PLSroundingLoop","title":"PLSrounding on portions of data at a time — PLSroundingLoop","text":"PLSrounding runs coordinated using preliminary differences input next run (parameter preDifference)","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingLoop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PLSrounding on portions of data at a time — PLSroundingLoop","text":"","code":"PLSroundingLoop(   data,   loopId,   ...,   zeroCandidates = FALSE,   forceInner = FALSE,   preRounded = NULL,   plsWeights = NULL,   printInc = TRUE,   preDifference = TRUE,   preOutput = NULL,   rndSeed = 123 )"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingLoop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PLSrounding on portions of data at a time — PLSroundingLoop","text":"data Input data data frame (inner cells) loopId Variable holding id loops ... PLSrounding parameters zeroCandidates PLSrounding parameter (see details) forceInner PLSrounding parameter (see details) preRounded PLSrounding parameter (see details) plsWeights PLSrounding parameter (see details) printInc Printing iteration information console TRUE preDifference TRUE, preDifference parameter PLSrounding used. time differences obtained far. preOutput preOutput function can continue output previous run rndSeed non-NULL, random generator seed set locally beginning PLSroundingLoop without affecting random value stream R. Within PLSroundingLoop, PLSrounding called rndSeed = NULL.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingLoop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PLSrounding on portions of data at a time — PLSroundingLoop","text":"output PLSrounding","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingLoop.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"PLSrounding on portions of data at a time — PLSroundingLoop","text":"Note function zeroCandidates, forceInner, preRounded plsWeights supplied vectors. may specified functions variables input data.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/PLSroundingLoop.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PLSrounding on portions of data at a time — PLSroundingLoop","text":"","code":"mf2 <- ~region + fylke * hovedint z2 <- SmallCountData(\"z2\") a <- PLSroundingLoop(z2, loopId = \"kostragr\", freqVar = \"ant\", formula = mf2) #>    1: [] #>    2: [-] a #>  #> PLSrounding summary:   #>  #>        maxdiff      HDutility    meanAbsDiff rootMeanSquare  #>              1         0.9873         0.2391          0.489  #>  #> Frequencies of cell frequencies and absolute differences:   #>  #>          inn.0 inn.1-2 inn.3 inn.4+ inn.all pub.0 pub.1-2 pub.3 pub.4+ pub.all #> original     2       4     2     36      44     .       2     .     44      46 #> rounded      3       1     4     36      44     1       .     1     44      46 #> absDiff     41       3     .      .      44    35      11     .      .      46 #>"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Round2.html","id":null,"dir":"Reference","previous_headings":"","what":"Small count rounding by various methods — Round2","title":"Small count rounding by various methods — Round2","text":"Run makeroundtabs() RoundViaDummy2()","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Round2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Small count rounding by various methods — Round2","text":"","code":"Round2(data, control, ..., method = c(\"roundtabs\", \"viadummy\", \"viadummyAll\"))"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Round2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Small count rounding by various methods — Round2","text":"data Input data.frame. input parameter makeroundtabs() control input makeroundtabs() ... paramameters input makeroundtabs() method One \"roundtabs\" (default), \"viadummy\", \"viadummyAll\" (allTerms=TRUE)","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Round2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Small count rounding by various methods — Round2","text":"Output  makeroundtabs RoundViaDummy2","code":""},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/Round2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Small count rounding by various methods — Round2","text":"","code":"if (FALSE) { # \\dontrun{ z <- SmallCountData(\"sosialFiktiv\") d <- list(c(\"region\",\"mnd\") , c(\"hovedint\",\"mnd2\") , c(\"fylke\",\"hovedint\",\"mnd2\") ,            c(\"kostragr\",\"hovedint\",\"mnd\")) con <- MakeControl(d,z) sor <- names(z)[c(4,5,3,2,1)]  roundedA <-  Round2(data=z,b=3,d=d,micro=FALSE,sort=sor,control=con, nin=\"ant\",nout=\"Rndtall\",                     minit=2,maxit=10,maxdiff=5,seed=123,method=\"roundtabs\") roundedB <-  Round2(data=z,b=3,d=d,micro=FALSE,sort=sor,control=con, nin=\"ant\",nout=\"Rndtall\",                     minit=2,maxit=10,maxdiff=5,seed=123,method=\"viadummy\") #10 rows of rounded data roundedA$Ar[1:10,]  #\"roundtabs\" cbind(z,roundedB$yInner)[1:10,] #\"viadummy\"  # recalculate maxdiff  nMaxdiff dA <- FindMaxDiff(roundedA$Ar,con,\"ant\",\"m\") dB <- FindMaxDiff(z,con,roundedB$yInner[,1],roundedB$yInner[,2])  # Formula from d and control Lists2formula(d,con,z)  # Formula from another d d2 <-list(sor) Lists2formula(d2,con,z) Lists2formula(d2,con) # Without knowing data Lists2formula(d2,data=z) # Without control Lists2formula(d2,data=z) # Without control and data } # }"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy.html","id":null,"dir":"Reference","previous_headings":"","what":"Small Count Rounding of Tabular Data — RoundViaDummy","title":"Small Count Rounding of Tabular Data — RoundViaDummy","text":"Small count rounding via dummy matrix algorithm inspired PLS","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Small Count Rounding of Tabular Data — RoundViaDummy","text":"","code":"RoundViaDummy(   data,   freqVar,   formula = NULL,   roundBase = 3,   singleRandom = FALSE,   crossTable = TRUE,   total = \"Total\",   maxIterRows = 1000,   maxIter = 1e+07,   x = NULL,   hierarchies = NULL,   xReturn = FALSE,   maxRound = roundBase - 1,   zeroCandidates = FALSE,   forceInner = FALSE,   identifyNew = TRUE,   step = 0,   preRounded = NULL,   leverageCheck = FALSE,   easyCheck = TRUE,   printInc = TRUE,   rndSeed = 123,   dimVar = NULL,   plsWeights = NULL,   preDifference = NULL,   allSmall = FALSE,   ... )"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Small Count Rounding of Tabular Data — RoundViaDummy","text":"data Input data data frame (inner cells) freqVar Variable holding counts (name number) formula Model formula defining publishable cells. used calculate x (via ModelMatrix). NULL, x must supplied. roundBase Rounding base singleRandom Single random draw TRUE (instead algorithm) crossTable TRUE, cross table output caculations via FormulaSums() total String used name totals maxIterRows See details maxIter Maximum number iterations x Dummy matrix defining publishable cells hierarchies List hierarchies, can converted AutoHierarchies. Thus, single string hierarchy input assumed total code. Exceptions \"rowFactor\" \"\", correspond using categories data. xReturn Dummy matrix output TRUE (input parameter x) maxRound Inner cells contributing original publishable cells equal less maxRound rounded. zeroCandidates TRUE, inner cells input zero count (multiple roundBase maxRound use) contributing publishable cells included candidates obtain roundBase value. vector input, rule specified individually cell. can specified vector, variable data function generating (see details). forceInner TRUE, inner cells rounded. Use vector input force individual cells rounded. can specified vector, variable data function generating (see details). Can combined parameter zeroCandidates allow zeros roundBase multiples rounded . identifyNew TRUE, new cells may identified initial rounding ensure rounded publishable cells equal less maxRound roundBase multiples. Use NA less conservative behavior (old behavior). ensured nonzero rounded publishable cells smaller roundBase. maxRound default, difference TRUE NA. step step>1, original forward part algorithm replaced kind stepwise. step steps forward, backward steps may performed. step parameter also used backward-forward iteration end algorithm; step backward steps may performed. greater control, step parameter can specified vector. Additionally, can provided list trigger final re-run iteration. See details. preRounded vector variable data contains mixture missing values predetermined values rounded inner cells. Can also specified function generating (see details). leverageCheck TRUE, inner cells depends linearly published cells small frequencies (<=maxRound) rounded. computation leverages can time memory consuming. function Reduce0exact called. default leverage limit 0.999999. Another limit can sent input instead TRUE. Checking performed (since new zeros) rounding. Extra iterations performed needed. easyCheck light version leverage checking. Checking performed rounding. Extra iterations performed needed. Reduce0exact called reduceByLeverage=FALSE reduceByColSums=TRUE. printInc Printing iteration information console TRUE rndSeed non-NULL, random generator seed used locally within function without affecting random value stream R. dimVar main dimensional variables additional aggregating variables. parameter can  useful hierarchies formula unspecified. plsWeights vector weights cell published function generating (see details). use algorithm criterion. preDifference data.frame differences already obtained rounding another subset data. must columns match crossTable. Differences must last column. allSmall TRUE, small inner cells (<= maxRound) rounded. parameter simplified alternative specifying forceInner  (see details). ... parameters sent ModelMatrix. particular, one can specify removeEmpty=TRUE omit empty combinations. parameter inputInOutput can used specify whether include codes input. parameter avoidHierarchical (Formula2ModelMatrix) can combined formula input.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Small Count Rounding of Tabular Data — RoundViaDummy","text":"list two first elements two column matrices. first matrix consists inner cells second cells published. matrix first second column contains, respectively, original rounded values. default cross table third element output list.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Small Count Rounding of Tabular Data — RoundViaDummy","text":"Small count rounding necessary inner cells performed small frequencies cross-classifications published (publishable cells) rounded. equivalent changing micro data since frequencies unique combinations changed. Thus, additivity consistency guaranteed. matrix multiplication formula : yPublish = t(x) %*%  yInner, x dummy matrix. Parameters zeroCandidates, forceInner,  preRounded plsWeights can specified functions. supplied functions take following arguments: data, yPublish,  yInner, crossTable, x, roundBase, maxRound, ..., first two numeric vectors original counts. allSmall TRUE,  forceInner set  function(yInner, maxRound, ...) yInner <= maxRound. Details step parameter: step numeric vector converted three parameters step1 <- step[1] step2 <- ifelse(length(step)>=2, step[2], round(step/2)) step3 <- ifelse(length(step)>=3, step[3], step[1]) step1 steps forward, step2 backward steps may performed. end algorithm;  step3 backward steps may executed repeatedly. step provided list (numeric vectors), adjusted length 3 using rep_len(step, 3). step[[1]] used main iterations. step[[2]], non-NULL, used final re-run iteration. step[[3]] used extra iterations caused easyCheck leverageCheck. Setting step = list(0) result standard behavior, exception extra re-run iteration performed. detailed setting achieved setting step length-3 list element length 3.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Small Count Rounding of Tabular Data — RoundViaDummy","text":"Iterations needed since initial rounding identified cells, new cells identified. cases high number identified cells algorithm can memory consuming (unless singleRandom=TRUE). avoid problems, maxIterRows cells rounded iteration. iteration limit (maxIter) default set high since low number maxIterRows may need high number iterations.","code":""},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Small Count Rounding of Tabular Data — RoundViaDummy","text":"","code":"# See similar and related examples in PLSrounding documentation RoundViaDummy(SmallCountData(\"e6\"), \"freq\") #> [-**.:=] #> $yInner #>      original rounded #> [1,]        2       3 #> [2,]        3       3 #> [3,]        7       7 #> [4,]        1       0 #> [5,]        5       5 #> [6,]        6       6 #>  #> $yPublish #>                original rounded #> Total:Total          24      24 #> Total:2018           12      13 #> Total:2019           12      11 #> EU:Total             21      21 #> EU:2018              10      10 #> EU:2019              11      11 #> nonEU:Total           3       3 #> nonEU:2018            2       3 #> nonEU:2019            1       0 #> Iceland:Total         3       3 #> Iceland:2018          2       3 #> Iceland:2019          1       0 #> Portugal:Total        8       8 #> Portugal:2018         3       3 #> Portugal:2019         5       5 #> Spain:Total          13      13 #> Spain:2018            7       7 #> Spain:2019            6       6 #>  #> $crossTable #>         geo  year #> 1     Total Total #> 2     Total  2018 #> 3     Total  2019 #> 4        EU Total #> 5        EU  2018 #> 6        EU  2019 #> 7     nonEU Total #> 8     nonEU  2018 #> 9     nonEU  2019 #> 10  Iceland Total #> 11  Iceland  2018 #> 12  Iceland  2019 #> 13 Portugal Total #> 14 Portugal  2018 #> 15 Portugal  2019 #> 16    Spain Total #> 17    Spain  2018 #> 18    Spain  2019 #>  RoundViaDummy(SmallCountData(\"e6\"), \"freq\", formula = ~eu * year + geo) #> [-**.:=] #> $yInner #>      original rounded #> [1,]        2       3 #> [2,]        3       3 #> [3,]        7       7 #> [4,]        1       0 #> [5,]        5       5 #> [6,]        6       6 #>  #> $yPublish #>                original rounded #> Total-Total          24      24 #> Total-EU             21      21 #> Total-nonEU           3       3 #> 2018-Total           12      13 #> 2019-Total           12      11 #> Total-Iceland         3       3 #> Total-Portugal        8       8 #> Total-Spain          13      13 #> 2018-EU              10      10 #> 2019-EU              11      11 #> 2018-nonEU            2       3 #> 2019-nonEU            1       0 #>  #> $crossTable #>     year      geo #> 1  Total    Total #> 2  Total       EU #> 3  Total    nonEU #> 4   2018    Total #> 5   2019    Total #> 6  Total  Iceland #> 7  Total Portugal #> 8  Total    Spain #> 9   2018       EU #> 10  2019       EU #> 11  2018    nonEU #> 12  2019    nonEU #>  RoundViaDummy(SmallCountData(\"e6\"), \"freq\", hierarchies =     list(geo = c(\"EU\", \"@Portugal\", \"@Spain\", \"Iceland\"), year = c(\"2018\", \"2019\"))) #> [-**.:=] #> $yInner #>      original rounded #> [1,]        2       3 #> [2,]        3       3 #> [3,]        7       7 #> [4,]        1       0 #> [5,]        5       5 #> [6,]        6       6 #>  #> $yPublish #>                original rounded #> Total:Total          24      24 #> Total:2018           12      13 #> Total:2019           12      11 #> EU:Total             21      21 #> EU:2018              10      10 #> EU:2019              11      11 #> Iceland:Total         3       3 #> Iceland:2018          2       3 #> Iceland:2019          1       0 #> Portugal:Total        8       8 #> Portugal:2018         3       3 #> Portugal:2019         5       5 #> Spain:Total          13      13 #> Spain:2018            7       7 #> Spain:2019            6       6 #>  #> $crossTable #>         geo  year #> 1     Total Total #> 2     Total  2018 #> 3     Total  2019 #> 4        EU Total #> 5        EU  2018 #> 6        EU  2019 #> 7   Iceland Total #> 8   Iceland  2018 #> 9   Iceland  2019 #> 10 Portugal Total #> 11 Portugal  2018 #> 12 Portugal  2019 #> 13    Spain Total #> 14    Spain  2018 #> 15    Spain  2019 #>   RoundViaDummy(SmallCountData('z2'),                'ant', ~region + hovedint + fylke*hovedint + kostragr*hovedint, 10) #> [-**..:=] #> $yInner #>       original rounded #>  [1,]       11      11 #>  [2,]        7      10 #>  [3,]        5       5 #>  [4,]       13      13 #>  [5,]        9       9 #>  [6,]       12      12 #>  [7,]        6       6 #>  [8,]        9       9 #>  [9,]        3       3 #> [10,]        9       9 #> [11,]        4       4 #> [12,]       11      11 #> [13,]        1       0 #> [14,]        8       8 #> [15,]        2       2 #> [16,]       14      14 #> [17,]        9       9 #> [18,]        4      10 #> [19,]        3       0 #> [20,]        0       0 #> [21,]        0       0 #> [22,]        2       0 #> [23,]       55      55 #> [24,]       29      29 #> [25,]       35      35 #> [26,]       17      17 #> [27,]       63      63 #> [28,]       24      24 #> [29,]       22      22 #> [30,]       38      38 #> [31,]        9       9 #> [32,]       32      32 #> [33,]       18      18 #> [34,]       36      36 #> [35,]       18      18 #> [36,]       25      25 #> [37,]       13      13 #> [38,]       52      52 #> [39,]       22      22 #> [40,]        8       8 #> [41,]       15      15 #> [42,]        2       2 #> [43,]       20      20 #> [44,]       11      11 #>  #> $yPublish #>                original rounded #> Total-Total         706     709 #> A-Total             113     113 #> B-Total              55      57 #> C-Total              73      73 #> D-Total              45      45 #> E-Total             138     138 #> F-Total              67      67 #> G-Total              40      46 #> H-Total              65      62 #> I-Total              14      14 #> J-Total              61      61 #> K-Total              35      33 #> Total-annet          88      91 #> Total-arbeid         54      54 #> Total-soshjelp      342     342 #> Total-trygd         222     222 #> 1-Total             127     127 #> 4-Total              55      57 #> 5-Total             118     118 #> 6-Total             205     205 #> 8-Total             105     108 #> 10-Total             96      94 #> 300-Total           596     601 #> 400-Total           110     108 #> 1-annet              14      14 #> 4-annet               7      10 #> 5-annet              18      18 #> 6-annet              21      21 #> 8-annet              15      15 #> 10-annet             13      13 #> 1-arbeid             11      11 #> 4-arbeid              1       0 #> 5-arbeid             10      10 #> 6-arbeid             23      23 #> 8-arbeid              7      10 #> 10-arbeid             2       0 #> 1-soshjelp           64      64 #> 4-soshjelp           29      29 #> 5-soshjelp           52      52 #> 6-soshjelp           87      87 #> 8-soshjelp           60      60 #> 10-soshjelp          50      50 #> 1-trygd              38      38 #> 4-trygd              18      18 #> 5-trygd              38      38 #> 6-trygd              74      74 #> 8-trygd              23      23 #> 10-trygd             31      31 #> 300-annet            72      75 #> 400-annet            16      16 #> 300-arbeid           52      54 #> 400-arbeid            2       0 #> 300-soshjelp        283     283 #> 400-soshjelp         59      59 #> 300-trygd           189     189 #> 400-trygd            33      33 #>  #> $crossTable #>    region hovedint #> 1   Total    Total #> 2       A    Total #> 3       B    Total #> 4       C    Total #> 5       D    Total #> 6       E    Total #> 7       F    Total #> 8       G    Total #> 9       H    Total #> 10      I    Total #> 11      J    Total #> 12      K    Total #> 13  Total    annet #> 14  Total   arbeid #> 15  Total soshjelp #> 16  Total    trygd #> 17      1    Total #> 18      4    Total #> 19      5    Total #> 20      6    Total #> 21      8    Total #> 22     10    Total #> 23    300    Total #> 24    400    Total #> 25      1    annet #> 26      4    annet #> 27      5    annet #> 28      6    annet #> 29      8    annet #> 30     10    annet #> 31      1   arbeid #> 32      4   arbeid #> 33      5   arbeid #> 34      6   arbeid #> 35      8   arbeid #> 36     10   arbeid #> 37      1 soshjelp #> 38      4 soshjelp #> 39      5 soshjelp #> 40      6 soshjelp #> 41      8 soshjelp #> 42     10 soshjelp #> 43      1    trygd #> 44      4    trygd #> 45      5    trygd #> 46      6    trygd #> 47      8    trygd #> 48     10    trygd #> 49    300    annet #> 50    400    annet #> 51    300   arbeid #> 52    400   arbeid #> 53    300 soshjelp #> 54    400 soshjelp #> 55    300    trygd #> 56    400    trygd #>  mf <- ~region*mnd + hovedint*mnd + fylke*hovedint*mnd + kostragr*hovedint*mnd a <- RoundViaDummy(SmallCountData('z3'), 'ant', mf, 5) #> [-**........=-**.:=-**.:=] b <- RoundViaDummy(SmallCountData('sosialFiktiv'), 'ant', mf, 4) #> [-**.........:=] print(cor(b[[2]]),digits=12) # Correlation between original and rounded #>                original        rounded #> original 1.000000000000 0.999999987033 #> rounded  0.999999987033 1.000000000000  # Demonstrate parameter leverageCheck  # The 42nd inner cell must be rounded since it can be revealed from the published cells. mf2 <- ~region + hovedint + fylke * hovedint + kostragr * hovedint RoundViaDummy(SmallCountData(\"z2\"), \"ant\", mf2, leverageCheck = FALSE)$yInner[42, ] #> [-**.:=] #> original  rounded  #>        2        2  RoundViaDummy(SmallCountData(\"z2\"), \"ant\", mf2, leverageCheck = TRUE)$yInner[42, ] #> [{-x-=H-}(check:1)-**..:={-zx-=H-}] #> original  rounded  #>        2        3   if (FALSE) { # \\dontrun{ # Demonstrate parameters maxRound, zeroCandidates and forceInner  # by tabulating the inner cells that have been changed. z4 <- SmallCountData(\"sosialFiktiv\") for (forceInner in c(\"FALSE\", \"z4$ant < 10\"))    for (zeroCandidates in c(FALSE, TRUE))      for (maxRound in c(2, 5)) {       set.seed(123)       a <- RoundViaDummy(z4, \"ant\", formula = mf, maxRound = maxRound,                           zeroCandidates = zeroCandidates,                           forceInner = eval(parse(text = forceInner)))       change <- a$yInner[, \"original\"] != a$yInner[, \"rounded\"]       cat(\"\\n\\n---------------------------------------------------\\n\")       cat(\"      maxRound:\", maxRound, \"\\n\")       cat(\"zeroCandidates:\", zeroCandidates, \"\\n\")       cat(\"    forceInner:\", forceInner, \"\\n\\n\")       print(table(original = a$yInner[change, \"original\"], rounded = a$yInner[change, \"rounded\"]))       cat(\"---------------------------------------------------\\n\")     } } # }"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy2.html","id":null,"dir":"Reference","previous_headings":"","what":"RoundViaDummy2 — RoundViaDummy2","title":"RoundViaDummy2 — RoundViaDummy2","text":"RoundViaDummy input makeroundtabs","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RoundViaDummy2 — RoundViaDummy2","text":"","code":"RoundViaDummy2(   data,   b,   d,   nin,   micro = FALSE,   control = NULL,   allTerms = FALSE,   singleRandom = FALSE )"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RoundViaDummy2 — RoundViaDummy2","text":"data data b b d d nin nin micro micro control control allTerms Use interaction terms formula instead using control singleRandom Single random draw TRUE (instead algorithm)","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/RoundViaDummy2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RoundViaDummy2 — RoundViaDummy2","text":"Output RoundViaDummy extended  \"yControl\" \"maxdiff\"  \"nMaxdiff\" \"formula\"","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountData.html","id":null,"dir":"Reference","previous_headings":"","what":"Function that returns a dataset — SmallCountData","title":"Function that returns a dataset — SmallCountData","text":"Function returns dataset","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function that returns a dataset — SmallCountData","text":"","code":"SmallCountData(dataset, path = NULL)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function that returns a dataset — SmallCountData","text":"dataset Name data set within SmallCountRounding  package path non-NULL data set read \"path/dataset.RData\"","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function that returns a dataset — SmallCountData","text":"dataset","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountData.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Function that returns a dataset — SmallCountData","text":"Except \"europe6\", \"eHrc\", \"eDimList\" \"exPSD\", function returns datasets SSBtoolsData.","code":""},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function that returns a dataset — SmallCountData","text":"","code":"SmallCountData(\"z1\") #>    region hovedint ant #> 1       A    annet  11 #> 2       B    annet   7 #> 3       C    annet   5 #> 4       D    annet  13 #> 5       E    annet   9 #> 6       F    annet  12 #> 7       G    annet   6 #> 8       H    annet   9 #> 9       A   arbeid  11 #> 10      B   arbeid   1 #> 11      C   arbeid   8 #> 12      D   arbeid   2 #> 13      E   arbeid  14 #> 14      F   arbeid   9 #> 15      G   arbeid   4 #> 16      H   arbeid   3 #> 17      A soshjelp  55 #> 18      B soshjelp  29 #> 19      C soshjelp  35 #> 20      D soshjelp  17 #> 21      E soshjelp  63 #> 22      F soshjelp  24 #> 23      G soshjelp  22 #> 24      H soshjelp  38 #> 25      A    trygd  36 #> 26      B    trygd  18 #> 27      C    trygd  25 #> 28      D    trygd  13 #> 29      E    trygd  52 #> 30      F    trygd  22 #> 31      G    trygd   8 #> 32      H    trygd  15  SmallCountData(\"e6\") #>        geo    eu year freq #> 1  Iceland nonEU 2018    2 #> 2 Portugal    EU 2018    3 #> 3    Spain    EU 2018    7 #> 4  Iceland nonEU 2019    1 #> 5 Portugal    EU 2019    5 #> 6    Spain    EU 2019    6  SmallCountData(\"eHrc\")      #  TauArgus coded hierarchies #> $geo #> [1] \"EU\"        \"@Portugal\" \"@Spain\"    \"nonEU\"     \"@Iceland\"  #>  #> $year #> [1] \"2018\" \"2019\" #>   SmallCountData(\"eDimList\")  #  sdcTable coded hierarchies #> $geo #>   levels    codes #> 1      @    Total #> 2     @@       EU #> 3    @@@ Portugal #> 4    @@@    Spain #> 5     @@    nonEU #> 6    @@@  Iceland #>  #> $year #>   levels codes #> 1      @ Total #> 2     @@  2018 #> 3     @@  2019 #>   SmallCountData(\"exPSD\")     #  Example data in presentation at Privacy in statistical databases #>    rows cols freq #> 1  row1 col1    6 #> 2  row2 col1    1 #> 3  row3 col1    0 #> 4  row1 col2    0 #> 5  row2 col2    2 #> 6  row3 col2    1 #> 7  row1 col3    1 #> 8  row2 col3    3 #> 9  row3 col3    1 #> 10 row1 col4    3 #> 11 row2 col4    1 #> 12 row3 col4    0 #> 13 row1 col5    4 #> 14 row2 col5    2 #> 15 row3 col5    2"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountRounding-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Small Count Rounding of Tabular Data — SmallCountRounding-package","title":"Small Count Rounding of Tabular Data — SmallCountRounding-package","text":"statistical disclosure control tool protect frequency tables cases small values sensitive. main function, PLSrounding, performs small count rounding necessary inner cells (Heldal, 2017) small frequencies cross-classifications published (publishable cells) rounded. equivalent changing micro data since frequencies unique combinations changed. Thus, additivity consistency guaranteed. performed algorithm inspired partial least squares regression (Langsrud Heldal, 2018).","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountRounding-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Small Count Rounding of Tabular Data — SmallCountRounding-package","text":"Heldal, J. (2017): “European Census Hub 2011 Hypercubes - Norwegian SDC Experiences”. : Work Session Statistical Data Confidentiality, Skopje, former Yugoslav Republic Macedonia, September 20-22 , 2017. Langsrud, Ø. Heldal, J. (2018): “Algorithm Small Count Rounding Tabular Data”. Presented : Privacy statistical databases, Valencia, Spain. September 26-28, 2018. https://www.researchgate.net/publication/327768398_An_Algorithm_for_Small_Count_Rounding_of_Tabular_Data","code":""},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/SmallCountRounding-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Small Count Rounding of Tabular Data — SmallCountRounding-package","text":"Maintainer: Øyvind Langsrud oyl@ssb.Authors: Johan Heldal","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/aggrtab.html","id":null,"dir":"Reference","previous_headings":"","what":"function aggrtab — aggrtab","title":"function aggrtab — aggrtab","text":"function aggrtab","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/aggrtab.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"function aggrtab — aggrtab","text":"","code":"aggrtab(A, d, micro = TRUE, nin = \"n\", nout = \"n\")"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/aggrtab.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"function aggrtab — aggrtab","text":"data frame representing micro dataset frequency count hypercube. (first) columns define variables. hypercube last column contains number units cell. d list d{[[j]]} whose elements vectors variable names defining marginal tables/cubes interested . micro Logical. TRUE micro dataset (default). FALSE frequency count hypercube. nin Name count variable hypercube. Default name: \"n\". nout Name frequency count variable output tables.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/aggrtab.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"function aggrtab — aggrtab","text":"D = {D[[j]]} marginal tables/cubes spesified list d = d{[[j]]} generated      aggregating cells .","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/aggrtab.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"function aggrtab — aggrtab","text":"Johan Heldal, November 2017","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/makeroundtabs.html","id":null,"dir":"Reference","previous_headings":"","what":"function makeroundtabs — makeroundtabs","title":"function makeroundtabs — makeroundtabs","text":"function creates set consistently rounded frequency count tables hypercubes means version small count rounding.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/makeroundtabs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"function makeroundtabs — makeroundtabs","text":"","code":"makeroundtabs(   A,   b = 3,   d,   micro = \"TRUE\",   sort,   control,   nin = \"n\",   nout = \"n\",   minit = 3,   maxit = 3,   maxdiff = 5,   seed )"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/makeroundtabs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"function makeroundtabs — makeroundtabs","text":"data frame representing micro dataset frequency count hypercube. (first) columns define variables. hypercube last column contains number units cell. micro dataset reduced hypercube function aggrtab. b Rounding base. Counts less b tat contributing counts less b marginal cubes D selected . selected dataframe called B d list d{[[j]]} whose elements vectors variable names defining marginal tables/cubes D interested . micro Logical. TRUE micro dataset (default). FALSE frequency count hypercube. sort ordered list variables hypercubes D meant priority sorting reduced hypercube B rounding. variables D included. control list marginals hypercubes D deviations aggregated rounded counts checked original counts. nin Name count variable hypercube. Default name: \"n\". nout Name frequency count variable output tables. minit Minimum number searches carried . maxit Maximum number searches carried . maxdiff maximum difference \"control\" larger maxit, stop search. seed Input seed first systematic random search.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/makeroundtabs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"function makeroundtabs — makeroundtabs","text":"Ar: rounded version Br: rounded version B D: original hypercube interest. Dr: rounded version D. final table interest. maxdiff: largest absolute difference cells D Dr among cells control list. nmaxdiff: number occurences Maxdiff","code":""},{"path":[]},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/makeroundtabs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"function makeroundtabs — makeroundtabs","text":"Johan Heldal, January 2018","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/print.PLSrounded.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for PLSrounded — print.PLSrounded","title":"Print method for PLSrounded — print.PLSrounded","text":"Print method PLSrounded","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/print.PLSrounded.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for PLSrounded — print.PLSrounded","text":"","code":"# S3 method for class 'PLSrounded' print(x, digits = max(getOption(\"digits\") - 3, 3), ...)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/print.PLSrounded.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for PLSrounded — print.PLSrounded","text":"x PLSrounded object digits positive integer.  Minimum number significant digits used printing numbers. ... arguments sent underlying","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/print.PLSrounded.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for PLSrounded — print.PLSrounded","text":"Invisibly returns original object.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/redcube.html","id":null,"dir":"Reference","previous_headings":"","what":"function redcube — redcube","title":"function redcube — redcube","text":"function produces reduced small count frequency hypercube rounding.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/redcube.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"function redcube — redcube","text":"","code":"redcube(A, d, b = 3, micro = TRUE, nin = \"n\")"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/redcube.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"function redcube — redcube","text":"data frame representing micro dataset frequency count hypercube. (first) columns define variables. hypercube last column contains number units cell. micro dataset reduced hypercube function aggrtab. d list d{[[j]]} whose elements vectors variable names defining marginal tables/cubes D interested . b Rounding base. Counts less b tat contributing counts less b marginal cubes D selected . selected dataframe called B micro Logical. TRUE micro dataset (default). FALSE frequency count hypercube. nin Name count variable hypercube. Default name: \"n\".","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/redcube.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"function redcube — redcube","text":": input dataframe reduced hypercube. B: dataframe small count rows selected . C: dataframe rows selected . D: cubes defined d. Dr: small counts (<b) D. input elements d, b nin","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/redcube.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"function redcube — redcube","text":"Johan Heldal, November 2017","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. SSBtools formula_selection, FormulaSelection, SSBtoolsData, tables_by_formulas","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/roundcube.html","id":null,"dir":"Reference","previous_headings":"","what":"function roundcube — roundcube","title":"function roundcube — roundcube","text":"function rounds small counts set hypercubes D produced function redcube searches solution smallest possible deviations original hypercube aggregated levels.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/roundcube.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"function roundcube — roundcube","text":"","code":"roundcube(rc, sort, control, minit, maxit, maxdiff, seed)"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/roundcube.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"function roundcube — roundcube","text":"rc list outpts redcube sort ordered list variables hypercubes D meant priority sorting reduced hypercube B rounding. variables D included. control list marginals hypercubes D deviations aggregated rounded counts checked original counts. minit Minimum number searches carried . maxit Maximum number searches carried . maxdiff maximum difference \"control\" larger maxit, stop search. seed Input seed first systematic random search.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/roundcube.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"function roundcube — roundcube","text":"Ar: rounded version    Br: rounded version B    D: original hypercube interest.    Dr: rounded version D. final table interest.    maxdiff: largest absolute difference cells D Dr among cells control list.    nmaxdiff: number occurences Maxdiff","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/reference/roundcube.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"function roundcube — roundcube","text":"Johan Heldal, January 2018","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-110","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 1.1.0","title":"SmallCountRounding 1.1.0","text":"CRAN release: 2024-12-09 breaking change may affect previous code. Previously, unspecified, dimVar automatically generated remaining columns. behavior correctly implemented, often stemmed user input errors lead unexpected behavior crashes. change now requires explicit input, making function robust reducing risk user errors. Input now explicitly coerced data frame using .data.frame() necessary ensure consistent behavior. preAggregate TRUE aggregatePackage \"data.table\", use .data.frame() skipped avoid unnecessary back--forth conversion data.table objects, preserving efficiency. Applies PLSrounding() wrappers. Output functions like get_klass() klassR package hier_create() sdcHierarchies package can now used directly input. Example usage: New possibilities working formulas hierarchies now available map_hierarchies_to_data() function. Improved functionality combining formulas Formula2ModelMatrix() parameter avoidHierarchical = TRUE, thanks new total_collapse() function can applied output.","code":"a <- get_klass(classification = \"24\")  b <- hier_create(root = \"Total\", nodes = LETTERS[1:5])  mydata <- data.frame(tree = sample(a$code[nchar(a$code) > 1], 200, replace = TRUE),                        letter = LETTERS[1:5])  PLSroundingPublish(mydata, roundBase = 5, hierarchies = list(tree = a, letter = b))"},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-108","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 1.0.8","title":"SmallCountRounding 1.0.8","text":"CRAN release: 2024-10-22 output dataset corresponding restricted part input formula can now easily retrieved. See examples documentation. relevant zeroCandidates = TRUE. old parameter PLSroundingFits() renamed extend0 extend0Fits. Code used old parameter now behave differently. Note extend0 extend0Fits can now specified advanced ways beyond just TRUE/FALSE. bug cause hang using step fixed. step parameter can now specified vector greater control. Additionally, can provided list trigger final re-run iteration. step parameter can significantly impact performance large datasets. example, using step = list(100) may useful approach. TRUE, NAs grouping variables omitted output included separate category. parameter can input PLSrounding() wrappers. Whether include NAs grouping variables preAggregate. Needs TRUE (default) utilize NAomit parameter. aggregatePackage parameter PLSrounding() wrappers. Also note related new parameters aggregateBaseOrder.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-105","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 1.0.5","title":"SmallCountRounding 1.0.5","text":"CRAN release: 2024-09-05 Changed package license MIT, accordance policy Statistics Norway. technical changes documentation comply standards.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-103","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 1.0.3","title":"SmallCountRounding 1.0.3","text":"CRAN release: 2022-11-16 Workaround old R versions isFALSE function defined.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-102","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 1.0.2","title":"SmallCountRounding 1.0.2","text":"CRAN release: 2022-10-12 New description identifyNew parameter: TRUE, new cells may identified initial rounding ensure rounded publishable cells equal less maxRound roundBase multiples. Use NA less conservative behavior (old behavior). ensured nonzero rounded publishable cells smaller roundBase. maxRound default, difference TRUE NA.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-100","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 1.0.0","title":"SmallCountRounding 1.0.0","text":"CRAN release: 2022-08-26  runs coordinated using preliminary differences input next run (parameter preDifference) supplied vectors PLSroundingLoop. TRUE, small inner cells (<= maxRound) rounded. simplified alternative specifying forceInner. Adaption needed Matrix ver. 1.4-2 (user-visible change)","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-090","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 0.9.0","title":"SmallCountRounding 0.9.0","text":"CRAN release: 2021-09-29 Expected inner cell frequencies generated iterative proportional fitting vector weights cell published function generating . use algorithm criterion.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-080","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 0.8.0","title":"SmallCountRounding 0.8.0","text":"CRAN release: 2021-04-26 Allowing empty freqVar input. new parameter preAggregate: TRUE, data aggregated beforehand within function dimensional variables. consequence parameter avoidHierarchical Formula2ModelMatrix SSBtools package.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-070","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 0.7.0","title":"SmallCountRounding 0.7.0","text":"CRAN release: 2021-03-09 Handled rndSeed, new parameter RoundViaDummy (PLSrounding). default, rndSeed = 123. means repeated runs equal input result equal output. get back old behaviour function, set rndSeed NULL. Handled output, new parameter PLSrounding. New wrapper functions, PLSroundingInner PLSroundingPublish. main dimensional variables additional aggregating variables. parameter can useful hierarchies formula unspecified.","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-060","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 0.6.0","title":"SmallCountRounding 0.6.0","text":"CRAN release: 2020-10-15 mixture missing values predetermined values rounded inner cells","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-050","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 0.5.0","title":"SmallCountRounding 0.5.0","text":"CRAN release: 2020-09-21 consequence function HierarchiesAndFormula2ModelMatrix SSBtools package provides protection possible disclosure small numbers linear relationships (difference attack) function Reduce0exact SSBtools package utilised Whether print iteration information console Parameter Hierarchies2ModelMatrix HierarchiesAndFormula2ModelMatrix SSBtools package Parameter functions Can used specify whether include codes input vignette, “Introduction ‘SmallCountRounding’”, included","code":""},{"path":"https://statisticsnorway.github.io/ssb-smallcountrounding/news/index.html","id":"smallcountrounding-040","dir":"Changelog","previous_headings":"","what":"SmallCountRounding 0.4.0","title":"SmallCountRounding 0.4.0","text":"CRAN release: 2019-10-17 Last version news","code":""}]
